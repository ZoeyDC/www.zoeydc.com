[{"content":"æœ¬ç¯‡æ•´ç† switch çš„å„ç¨®æ¨¡å¼æ¯”å°ï¼ˆè‡³ C# 9.0ï¼‰ï¼Œä¸»è¦åƒè€ƒå¾®è»Ÿæ–‡ç« (Patterns)ã€‚\næ¸¬è©¦ç’°å¢ƒï¼š\n .NET Framework 4.7.2 (C# 7.3)\n.NET 6.0 (C# 10)\n å¦‚æœæ¨™è¨˜ C# 9.0ï¼Œé è¨­åœ¨ .NET 5.x ä»¥ä¸Šæ‰å¯ä½¿ç”¨ï¼›C# 8.0 å‰‡æ˜¯ .NET Core 3.x å¾Œå¯ä»¥ç”¨ã€‚\nåŸºæœ¬æ¶æ§‹ï¼šåŸ·è¡Œé‹ç®—å¼ï¼Œç”±ä¸Šè€Œä¸‹æª¢æŸ¥åŸ·è¡Œçµæœç¬¦åˆå“ªå€‹ç‹€æ³ï¼Œå†åŸ·è¡Œè£¡é¢çš„é™³è¿°å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  switch (é‹ç®—å¼) { case ç‹€æ³ä¸€: Console.WriteLine(\u0026#34;ç‹€æ³ä¸€\u0026#34;); break; case ç‹€æ³äºŒ: Console.WriteLine(\u0026#34;ç‹€æ³äºŒ\u0026#34;); break; default: //å…¶ä»–ç‹€æ³  Console.WriteLine(\u0026#34;å…¶ä»–\u0026#34;); break; }   Declaration pattern å®£å‘Šæ¨¡å¼ (C# 7.0) ç•¶é‹ç®—çµæœä¸ç‚º null æ™‚ï¼Œæª¢æŸ¥æ­¤çµæœçš„ runtime å‹åˆ¥ï¼Œå¦‚æœå¯æ‰¾åˆ°å°æ‡‰çš„ç‹€æ³ï¼Œå‰‡è½‰å‹æ­¤çµæœä¸¦æŒ‡æ´¾çµ¦å®£å‘Šçš„è®Šæ•¸ã€‚å¦‚æœé‹ç®—çµæœæœ‰å¯èƒ½ç‚º nullï¼Œå¯å¢åŠ ç‹€æ³ null çš„æª¢æŸ¥ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static void ShowTypeAndValue(object obj) { switch (obj) { case int n: Console.WriteLine($\u0026#34;int:{n}\u0026#34;); break; case string s: Console.WriteLine($\u0026#34;string:{s}\u0026#34;); break; case null: throw new ArgumentNullException(nameof(obj)); default: throw new ArgumentException(\u0026#34;Unknown type\u0026#34;, nameof(obj)); } }   å®£å‘Šæ¨¡å¼ä¹Ÿå¯ä»¥ç”¨åœ¨é‹ç®—çµæœæ˜¯å¯ç‚º Null çš„å¯¦è³ªå‹åˆ¥è®Šæ•¸ï¼Œæª¢æŸ¥å…¶åŸºç¤é¡å‹ï¼›æˆ–æ˜¯ boxed çš„å¯¦è³ªå‹åˆ¥ï¼Œå­˜åœ¨æŸè½‰å‹æ–¹å¼ã€‚\nå¦‚æœåªæª¢æŸ¥å‹åˆ¥ï¼Œä¸éœ€è¦ä½¿ç”¨è½‰å‹å¾Œçš„è®Šæ•¸ï¼Œå¯ç”¨ _ æ›¿ä»£å®£å‘Šçš„è®Šæ•¸åç¨±ï¼Œæˆ–æ˜¯åœ¨ C# 9.0 å¾Œå¯ç”¨ã€Œé¡å‹æ¨¡å¼ã€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static void ShowType(object obj) { switch (obj) { case int _: Console.WriteLine($\u0026#34;int\u0026#34;); break; case string _: Console.WriteLine($\u0026#34;string\u0026#34;); break; case null: throw new ArgumentNullException(nameof(obj)); default: throw new ArgumentException(\u0026#34;Unknown type\u0026#34;, nameof(obj)); } }   Type pattern é¡å‹æ¨¡å¼ï¼ˆC# 9.0ï¼‰ é¡ä¼¼å®£å‘Šæ¨¡å¼ï¼Œä½†æ˜¯åªæƒ³æª¢æŸ¥é‹ç®—çµæœçš„å‹åˆ¥æ™‚å¯ä½¿ç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static void ShowType2(object obj) { switch (obj) { case int: Console.WriteLine($\u0026#34;int\u0026#34;); break; case string: Console.WriteLine($\u0026#34;string\u0026#34;); break; case null: throw new ArgumentNullException(nameof(obj)); default: throw new ArgumentException(\u0026#34;Unknown type\u0026#34;, nameof(obj)); } }   Constant pattern å¸¸æ•¸æ¨¡å¼ (C# 7.0) æª¢æŸ¥é‹ç®—çµæœæ˜¯å¦ç¬¦åˆæŒ‡å®šçš„ç‹€æ³ï¼Œè€Œé€™äº›ç‹€æ³æœƒæ˜¯å¸¸æ•¸çš„å½¢å¼ï¼ˆä»»ä½•çš„å¸¸æ•¸ï¼Œä¾‹å¦‚æ•´æ•¸ã€charã€å­—ä¸²ã€å¸ƒæ—å€¼ã€Enumã€å¸¸æ•¸æ¬„ä½æˆ–æ˜¯ null ç­‰ï¼ŒC# 9.0 å¾Œå¯ä»¥ç”¨ not nullï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static decimal GetDiscount(int itemCount) { switch (itemCount) { case 1: return 1m; case 2: return 0.95m; case 3: return 0.9m; case 4: return 0.8m; default: throw new ArgumentException($\u0026#34;Not supported number of items: {itemCount}\u0026#34;, nameof(itemCount)); } }   Relational pattern é—œè¯å¼æ¨¡å¼ï¼ˆC# 9.0ï¼‰ å°‡é‹ç®—çµæœèˆ‡å¸¸æ•¸åšæ¯”è¼ƒï¼Œæ¯å€‹ç‹€æ³ä¸­ï¼Œå¯ä»¥ç”¨é—œè¯é‹ç®—å­ï¼ˆ\u0026gt;ã€\u0026lt;ã€\u0026gt;=ã€\u0026lt;=ï¼‰ä¾†æè¿°å¦‚ä½•æ¯”è¼ƒï¼Œè€Œå¸¸æ•¸éƒ¨åˆ†éœ€è¦æ”¾åœ¨é—œè¯é‹ç®—å­çš„å³æ–¹ï¼›ä¹Ÿå¯ä»¥æ··ç”¨å¸¸æ•¸æ¨¡å¼ï¼Œæ¯”è¼ƒæ˜¯å¦èˆ‡å¸¸æ•¸å€¼ç›¸ç­‰ã€‚é€™è£¡çš„å¸¸æ•¸å¯ä»¥ç”¨æ•¸å€¼å‹åˆ¥ã€char æˆ– Enumã€‚\nä½¿ç”¨æ™‚è¦æ³¨æ„å„ç‹€æ³çš„é †åºæ’åˆ—ï¼Œä¾‹å¦‚ \u0026lt; 1 å¾Œå†æª¢æŸ¥ \u0026lt; 0ï¼Œå‰‡å¾Œé¢çš„ \u0026lt; 0 æ°¸é ä¸æœƒåŸ·è¡Œåˆ°ï¼Œç·¨è­¯å™¨æœƒè­¦å‘ŠéŒ¯èª¤ï¼Œç„¡æ³•ç·¨è­¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static string BMIResult(double bmi) { switch (bmi) { case \u0026lt; 0: throw new ArgumentException($\u0026#34;BMIç•°å¸¸\u0026#34;, nameof(bmi)); case \u0026lt; 18.5: return \u0026#34;é«”é‡éè¼•\u0026#34;; case \u0026lt; 24.0: return \u0026#34;å¥åº·é«”é‡\u0026#34;; case \u0026lt; 27.0: return \u0026#34;é«”é‡éé‡\u0026#34;; default: return \u0026#34;è‚¥èƒ–\u0026#34;; } }   å¯ä»¥åŠ ä¸Šé‚è¼¯æ¨¡å¼ä¸­çš„ and ä¾†æª¢æŸ¥é‹ç®—çµæœæ˜¯å¦åœ¨æŸç¯„åœå…§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static string BMIResult2(double bmi) { switch (bmi) { case \u0026lt; 0: throw new ArgumentException($\u0026#34;BMIç•°å¸¸\u0026#34;, nameof(bmi)); case \u0026gt;= 0 and \u0026lt; 18.5: return \u0026#34;é«”é‡éè¼•\u0026#34;; case \u0026gt;= 18.5 and \u0026lt; 24.0: return \u0026#34;å¥åº·é«”é‡\u0026#34;; case \u0026gt;= 24.0 and \u0026lt; 27.0: return \u0026#34;é«”é‡éé‡\u0026#34;; default: return \u0026#34;è‚¥èƒ–\u0026#34;; } }   Logical pattern é‚è¼¯æ¨¡å¼ï¼ˆC# 9.0ï¼‰ åœ¨ç‹€æ³è£¡é¢ï¼Œå¯ä»¥ç”¨ notã€andã€or çš„çµ„åˆä¾†è¡¨é”é‚è¼¯æ¦‚å¿µï¼Œåœ¨æ²’æœ‰æ‹¬å¼§çš„æƒ…æ³ä¸‹ï¼Œé‚è¼¯åˆ¤æ–·å„ªå…ˆé †åº not \u0026gt; and \u0026gt; orã€‚\nnot (å¦å®š) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  static string TestNull(object obj) { if (obj is not null) return \u0026#34;not null\u0026#34;; return \u0026#34;null\u0026#34;; } static string TestNull2(object obj) { switch (obj) { case not null: return \u0026#34;not null\u0026#34;; default: return \u0026#34;null\u0026#34;; } }   and (ä¸”) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  static string BMIResult2(double bmi) { switch (bmi) { case \u0026lt; 0: throw new ArgumentException($\u0026#34;BMIç•°å¸¸\u0026#34;, nameof(bmi)); case \u0026gt;= 0 and \u0026lt; 18.5: return \u0026#34;é«”é‡éè¼•\u0026#34;; case \u0026gt;= 18.5 and \u0026lt; 24.0: return \u0026#34;å¥åº·é«”é‡\u0026#34;; case \u0026gt;= 24.0 and \u0026lt; 27.0: return \u0026#34;é«”é‡éé‡\u0026#34;; default: return \u0026#34;è‚¥èƒ–\u0026#34;; } }   or (æˆ–) 1 2 3 4 5 6 7 8 9 10 11 12  static string BMIResult3(double bmi) { switch (bmi) { case \u0026lt; 0: throw new ArgumentException($\u0026#34;BMIç•°å¸¸\u0026#34;, nameof(bmi)); case \u0026lt; 18.5 or \u0026gt; 24.0: return \u0026#34;é«”é‡éè¼•æˆ–éé‡\u0026#34;; default: return \u0026#34;å¥åº·é«”é‡\u0026#34;; } }   Property pattern å±¬æ€§æ¨¡å¼ (C# 8.0) ä½¿ç”¨é‹ç®—å¼çµæœçš„å±¬æ€§æˆ–æ¬„ä½å€¼ä¾†é€²è¡Œæ¯”å°ï¼Œå±¬æ–¼éè¿´æ¨¡å¼ï¼ˆrecursive patternï¼‰ï¼Œå¯ä»¥åµŒå¥— ï¼ˆnestedï¼‰å…¶ä»–æ¨¡å¼æ¯”å°ï¼›ä¾‹å¦‚åœ¨å®£å‘Šæ¨¡å¼æˆ–å‹åˆ¥æ¨¡å¼ä¸­ï¼Œæª¢æŸ¥å‹åˆ¥å¤–ï¼Œäº¦å¯åŠ ä¸Šå±¬æ€§æ¨¡å¼ä¾†æª¢æŸ¥å…¶å±¬æ€§æˆ–æ¬„ä½çš„å€¼æ˜¯å¦ç¬¦åˆï¼›æˆ–è€…åœ¨å±¬æ€§æ¨¡å¼ä¸Šå¥—åµŒå±¬æ€§æ¨¡å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  static double GetRectangleArea(Rectangle rectangle) { switch (rectangle) { case { Width: 0 }: case { Height: 0 }: return 0; default: return rectangle.Height * rectangle.Width; } } static double GetArea(Shape shape) { switch (shape) { case Rectangle { Width: 0 }: case Rectangle { Height: 0 }: case Circle { Radius: 0 }: return 0; case Rectangle rectangle: return rectangle.Height * rectangle.Width; case Circle circle: return Math.PI * circle.Radius * circle.Radius; default: throw new ArgumentException(); } }   Positional pattern ä½ç½®æ¨¡å¼ (C# 8.0) Tuple çš„æ‡‰ç”¨ã€‚ç•¶é‹ç®—å¼çš„çµæœæ˜¯ Tuple æˆ–å…¶å‹åˆ¥å…·æœ‰è§£æ§‹æ–¹æ³•ï¼ˆDeconstruct methodï¼‰æ™‚ï¼Œå¯ä»¥é‡å°æ¯å€‹å…ƒç´ é€²è¡Œæ¯”å°ã€‚ä¹Ÿå±¬æ–¼éè¿´æ¨¡å¼ï¼ˆrecursive patternï¼‰ï¼Œå¾®è»Ÿæ–‡ä»¶ä¸­æœ‰æ›´å¤šçš„ç¯„ä¾‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  static decimal GetTotal(decimal price, int count) { switch (price, count) { case (\u0026gt;= 500, \u0026gt;= 10): return price * count * 0.8m; case (\u0026gt;= 500, \u0026gt; 0): case (\u0026gt;= 50, \u0026gt;= 10): return price * count * 0.9m; default: return price * count; } }   var pattern éš±å«å‹åˆ¥æ¨¡å¼ (C# 7.0) å°‡é‹ç®—å¼çš„çµæœæŒ‡æ´¾çµ¦æŸå€‹å€åŸŸè®Šæ•¸æ™‚ï¼Œæ­¤è®Šæ•¸å‹åˆ¥å¯ç”¨éš±å«å‹åˆ¥ var è¡¨é”ï¼Œå¸¸ç”¨åœ¨å–ä»£ default çš„ç‹€æ³ï¼Œè—‰ä»¥å°‡é‹ç®—çš„çµæœåœ¨ default çš„ç‹€æ³ä¸­å†æ¬¡ä½¿ç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  static bool TestValidBMI(Person person) { switch (person.GetBMI()) { case \u0026lt; 0: case null: Console.WriteLine($\u0026#34;Invalid BMI value!\u0026#34;); return false; case var bmi: Console.WriteLine($\u0026#34;Person with BMI {bmi} accepted!\u0026#34;); return true; } }   Discard pattern æ¨æ£„æ¨¡å¼ (C# 8.0) é…åˆ switch é‹ç®—å¼çš„ä½¿ç”¨ï¼Œdefault çš„éƒ¨åˆ†ç”¨åº•ç·š _ æ›¿ä»£ï¼Œæ›´ç‚ºç°¡æ½”ã€‚\n1 2 3 4 5 6  static int GetTypeLabel(object obj) =\u0026gt; obj switch { int n =\u0026gt; 1, string s =\u0026gt; 2, _ =\u0026gt; 3, };   Parenthesized pattern æ‹¬å¼§æ¨¡å¼ï¼ˆC# 9.0ï¼‰ åœ¨ä»»ä½•æ¨¡å¼çš„å‰å¾ŒåŠ ä¸Šæ‹¬å¼§ï¼Œä¾†å¼·èª¿æˆ–æ”¹è®ŠåŸæœ¬çš„é‚è¼¯é †åºã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  static string BMIResult4(double bmi) { switch (bmi) { case \u0026lt; 0: throw new ArgumentException($\u0026#34;BMIç•°å¸¸\u0026#34;, nameof(bmi)); case not (\u0026gt;= 18.5 and \u0026lt; 24.0): return \u0026#34;é«”é‡éè¼•æˆ–éé‡\u0026#34;; default: return \u0026#34;å¥åº·é«”é‡\u0026#34;; } }   å…¶ä»–ï¼š Case guards æ¡ˆä¾‹é˜²è­· (C# 7.0) åˆ©ç”¨ when ä¾†é™å®šå…¶ä»–è¦ç¬¦åˆçš„æ¢ä»¶ï¼Œwhen å¾Œé¢åŠ ä¸Šå¸ƒæ—é‹ç®—å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13  static decimal GetTotal2(decimal price, int count) { switch (price) { case \u0026gt;= 500 when count \u0026gt;= 10: return price * count * 0.8m; case \u0026gt;= 500: case \u0026gt;= 50 when count \u0026gt;= 10: return price * count * 0.9m; default: return price * count; } }   å…¶ä»–ï¼š switch é‹ç®—å¼ (C# 8.0) åœ¨ C# 8.0 å¾Œå¯ä»¥ä½¿ç”¨ expression body è®“ switch çš„å¯«æ³•æ›´ç°¡æ½”ï¼Œä¾‹å¦‚åŸæœ¬çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  static int GetTypeLabel(object obj) { switch (obj) { case int n: return 1; case string s: return 2; default: return 3; } }   å¯ä»¥å¯«æˆï¼š\n1 2 3 4 5 6  static int GetTypeLabel(object obj) =\u0026gt; obj switch { int n =\u0026gt; 1, string s =\u0026gt; 2, _ =\u0026gt; 3, };   é‹ç®—å¼ (obj) å’Œ switch çš„é †åºèª¿æ›ï¼Œæ¸›å» case å’Œ : çš„ä½¿ç”¨ï¼Œæ”¹ç”¨ =\u0026gt;ï¼›åŸæœ¬ case ä¹‹é–“å‰‡ä½¿ç”¨é€—è™Ÿ , åˆ†éš”ï¼Œå¦å¤– default ç”¨åº•ç·š _ è¡¨é”ï¼ˆæ¨æ£„æ¨¡å¼ï¼‰ã€‚\nç›¸é—œé€£çµï¼š  [Micorsoft Docs] Patterns [Micorsoft Docs] Selection statements [Micorsoft Docs] switch expression [Micorsoft Docs] C# language versioning  ","description":"æœ¬ç¯‡æ•´ç† switch çš„å„ç¨®æ¨¡å¼æ¯”å°ï¼ˆè‡³ C# 9.0ï¼‰ã€‚","id":0,"section":"posts","tags":["switch","pattern matching"],"title":"switch çš„æ¨¡å¼æ¯”å°","uri":"https://www.zoeydc.com/zh/posts/2022-04-16-switch_pattern_matching/"},{"content":"é—œæ–¼å®‰è£æª”çš„å»ºç«‹ï¼Œåœ¨é€™å…©ç¯‡æ–‡ç« ã€Œå»ºç«‹Installerã€å’Œã€Œåœ¨Visual Studioå°‡Windows Serviceæ‰“åŒ…æˆå®‰è£æª”ã€æœ‰æ‰¾åˆ°æ»¿è©³ç´°çš„èªªæ˜ï¼Œé€™è£¡ä¸»è¦æ˜¯è¨˜éŒ„è£½ä½œå®‰è£æª”æ™‚å…¶ä»–å¯èƒ½ç”¨åˆ°çš„åŠŸèƒ½ã€‚\n ä»¥ä¸‹å‡è¨­ MyExeProject æ˜¯è¦å®‰è£çš„ç›®æ¨™ç¨‹å¼å°ˆæ¡ˆå\n VS 2017/2019 å»ºç«‹ Installer Project å› ç‚º Installer Project åœ¨ Visual Studio 2017/2019 ä¸æ˜¯å…§å»ºçš„å°ˆæ¡ˆé¡å‹ï¼Œéœ€è¦å¦å¤–å®‰è£ Microsoft Visual Studio Installer Projectsã€‚\n Visual Studio 2017ï¼šå·¥å…· â†’ æ“´å……åŠŸèƒ½å’Œæ›´æ–°ã€‚\nVisual Studio 2019ï¼šå»¶ä¼¸æ¨¡çµ„ â†’ ç®¡ç†å»¶ä¼¸æ¨¡çµ„ã€‚\n  æœå°‹ã€ŒMicrosoft Visual Studio Installer Projectsã€ä¸‹è¼‰å®‰è£ç¨‹å¼ï¼Œç­‰é—œé–‰ Visual Studio å¾Œæœƒé€²è¡Œå®‰è£ï¼Œä¹‹å¾Œè¦å»ºç«‹ Installer çš„å°ˆæ¡ˆæ™‚æ‰¾åˆ°ã€ŒSetup Projectã€å³å¯ã€‚\n åŸ·è¡Œæª”åŠ å…¥æ•¸ä½ç°½ç« ï¼Œä¸¦æ‰“åŒ…é€²å®‰è£æª” é€²å…¥ MyExeProject å°ˆæ¡ˆçš„å±¬æ€§é é¢ï¼Œæ‰¾åˆ°ã€Œç°½ç½²ã€ï¼Œå‹¾é¸ã€Œç°½ç½² ClickOnce è³‡è¨Šæ¸…å–®ã€ï¼Œç„¶å¾Œå¾å­˜æ”¾å€æˆ–æª”æ¡ˆåŒ¯å…¥ç°½ç« ã€‚\n å†åˆ°ã€Œå®‰å…¨æ€§ã€é é¢ï¼Œå‹¾é¸ã€Œå•Ÿç”¨ ClickOnce å®‰å…¨æ€§è¨­å®šã€ã€‚\n é€™æ¨£ç¨‹å¼ç·¨è­¯å®Œå¾Œï¼Œåœ¨ bin çš„ Debug æˆ– Release å…§æ–°å»ºçš„è³‡æ–™å¤¾ app.publish ä¸­æœƒç”¢ç”Ÿå·²åŠ å…¥ç°½ç« çš„åŸ·è¡Œæª”ï¼Œä½†æ˜¯å®‰è£æª”å°ˆæ¡ˆåœ¨å»ºç½®æ™‚é€™å€‹æª”æ¡ˆä¸æœƒè‡ªå‹•åŒ…è£åˆ°å®‰è£æª”ä¸­ï¼Œæ‰€ä»¥é‚„éœ€è¦é¡å¤–é€²è¡Œè™•ç†ã€‚\nInstaller çš„å°ˆæ¡ˆè¼¸å‡ºå…¶å¯¦æ˜¯å¾ obj è³‡æ–™å¤¾ä¸­æŠ“éä¾†çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å®‰è£æª”å»ºç½®å‰ï¼Œå…ˆå°‡ obj ä¸­çš„æª”æ¡ˆå–ä»£æˆå·²ç¶“åŠ å…¥æ•¸ä½ç°½ç« çš„æª”æ¡ˆï¼Œå†é€²è¡Œå»ºç½®ã€‚\nå°±ç”¨ PreBuildEvent ä¾†è™•ç†ã€‚\n 1 2 3 4 5 6  REM åªåœ¨ Release çµ„æ…‹æ™‚é€²è¡Œ if \u0026#34;$(Configuration)\u0026#34; == \u0026#34;Release\u0026#34; ( cd \u0026#34;$(ProjectDir)\u0026#34; cd .. copy /Y \u0026#34;MyExeProject\\bin\\$(Configuration)\\app.publish\\MyExeProject.exe\u0026#34; \u0026#34;MyExeProject\\obj\\$(Configuration)\\MyExeProject.exe\u0026#34; )   å»ºç«‹å‚³å…¥å¼•æ•¸çš„æ·å¾‘ åœ¨æª”æ¡ˆç³»çµ±ï¼ˆFile Systemï¼‰å»ºç«‹æ·å¾‘å¾Œï¼Œæ·å¾‘çš„å±¬æ€§è¦–çª— Arguments æ¬„ä½å¡«å…¥å¼•æ•¸å³å¯ã€‚\n  åµæ¸¬æ‰€éœ€çš„ .NET Framework ç‰ˆæœ¬ å¦‚æœè»Ÿé«”å®‰è£å‰æœ‰å…¶ä»–å¿…é ˆå®‰è£çš„ .NET æˆ– SQL ç›¸é—œå…ƒä»¶ï¼Œå¯ä»¥åœ¨ Installer å°ˆæ¡ˆçš„å±¬æ€§é ã€ŒPrerequisties\u0026hellip;ã€é€²è¡Œè¨­å®šï¼Œå¦‚ä¸‹åœ–ï¼š\n å‹¾é¸ã€Œå»ºç«‹å®‰è£ç¨‹å¼ä»¥å®‰è£å¿…è¦æ¢ä»¶å…ƒä»¶ã€ï¼Œå³è¨­å®šå®‰è£æª”å»ºç½®å¾Œæœƒä¸€ä½µç”¢ç”Ÿ Setup.exe æª”æ¡ˆï¼Œè¦å®‰è£æ™‚å¿…é ˆå…ˆé»æ“Šé€™å€‹æª”æ¡ˆï¼Œå…ˆå®‰è£å¿…è¦çš„å…ƒä»¶ï¼Œå®‰è£å®Œå¾Œæœƒè‡ªå‹•é€²å…¥ç¨‹å¼çš„å®‰è£ã€‚\nä½†æ˜¯å³ä½¿æ©Ÿå™¨åŸæœ¬å·²ç¶“æœ‰è£äº†å‹¾é¸çš„å…ƒä»¶ï¼Œé‚„æ˜¯æœƒå•Ÿå‹•å¿…è¦å…ƒä»¶çš„å®‰è£ç¨‹å¼é€²è¡Œå®‰è£ï¼ˆè‡³å°‘æˆ‘æ¸¬è©¦æ˜¯é€™æ¨£ï¼‰ï¼Œè€Œä¸”é€™æ¨£ä¸€ä¾†éœ€è¦é‡‹å‡ºå…©å€‹æª”æ¡ˆï¼šSetup.exe å’Œä¸»è¦å®‰è£æª” msi æª”ï¼Œæ‰€ä»¥æœ€å¾Œæ²’ç”¨åˆ°é€™å€‹åŠŸèƒ½ã€‚\nè€Œ msi æª”æœ¬èº«å¯ä»¥è¨­å®šæ‰€éœ€çš„å•Ÿå‹•æ¢ä»¶ï¼Œä¾‹å¦‚ .NET Framework ç‰ˆæœ¬éœ€æ±‚ç­‰ï¼Œåœ¨ç‰ˆæœ¬æœªé”åˆ°æ™‚æœƒå‡ºç¾æç¤ºä¸”é–‹å•Ÿé è¨­çš„ä¸‹è¼‰é é¢ï¼Œè¨­å®šæ–¹å¼å¦‚ä¸‹ï¼š\n   ç•¶å®‰è£æ™‚ä½œæ¥­ç’°å¢ƒæœªé”åˆ°å•Ÿå‹•æ¢ä»¶æ™‚ï¼Œæœƒå‡ºç¾æç¤ºï¼š\n é€™æ¨£å®‰è£æ™‚åªéœ€è¦ msi æª”å³å¯ï¼Œè€Œä¸”ç’°å¢ƒé”åˆ°å•Ÿå‹•æ¢ä»¶å°±ä¸æœƒå‡ºç¾æç¤ºï¼Œè€Œæ˜¯ç›´æ¥é€²åˆ°å®‰è£ç¨‹åºã€‚\né™¤äº†æª¢æŸ¥ .NET Framework ç‰ˆæœ¬å¤–ï¼Œæ‡‰è©²å¯ä»¥åŠ ä¸Šæ›´è¤‡é›œçš„å•Ÿå‹•æ¢ä»¶è¨­å®šï¼Œå¦‚æœè¦å†æ·±å…¥ç ”ç©¶ï¼Œä¹Ÿè¨±å¯ä»¥åƒè€ƒå¾®è»Ÿç›¸é—œæ–‡ç« ã€ŒAdd launch conditionsã€ã€‚\nå®‰è£æ–°ç‰ˆç¨‹å¼æ™‚è‡ªå‹•å–ä»£èˆŠç‰ˆæœ¬ æ­¥é©Ÿå¦‚ä¸‹ï¼š\n è¨­å®š MyExeProject çš„ç‰ˆæœ¬è³‡è¨Šï¼šé€²åˆ°å°ˆæ¡ˆå±¬æ€§â†’æ‡‰ç”¨ç¨‹å¼é é¢â†’çµ„ä»¶è³‡è¨Šï¼Œè¨­å®šã€Œçµ„ä»¶ç‰ˆæœ¬ã€å’Œã€Œæª”æ¡ˆç‰ˆæœ¬ã€ç‚ºæ–°çš„ç‰ˆæœ¬è™Ÿï¼ˆè¨­å®šå‰ä¸‰ç¢¼ï¼Œç¬¬å››ç¢¼å¿½ç•¥ï¼‰ï¼Œä¾‹å¦‚ 3.1.2 ç‰ˆå¦‚ä¸‹ï¼š   è¨­å®š Installer å°ˆæ¡ˆçš„ç‰ˆæœ¬ï¼šå°ˆæ¡ˆå±¬æ€§æ¬„ä½ Version è¨­å®šå’Œæ­¥é©Ÿ 1 ç›¸åŒçš„ç‰ˆæœ¬è™Ÿï¼Œå¦‚æœè¨­å®šå¾Œè©¢å•æ˜¯å¦ä¿®æ”¹ ProductCodeï¼Œé¸ã€Œæ˜¯ã€ï¼ˆè‹¥æœªè©¢å•ï¼Œå‰‡æ‰‹å‹•æ›´æ–° ProductCodeï¼‰ã€‚   ç¢ºèª Installer å°ˆæ¡ˆçš„å±¬æ€§ï¼šDetectNewerInstalledVersion å’Œ RemovePreviousVersions ç‚º Trueã€‚   é€™æ¨£æœªä¾†æ›´æ–°ç‰ˆæœ¬è™Ÿï¼Œåªè¦å°‡ç‰ˆè™Ÿå¢åŠ ï¼Œé‡è¤‡ 1 å’Œ 2 å…©å€‹æ­¥é©Ÿçš„è¨­å®šï¼Œå®‰è£æ–°ç‰ˆæœ¬æ™‚å°±å¯ä»¥è‡ªå‹•è¦†è“‹èˆŠç‰ˆæœ¬æª”æ¡ˆï¼Œä¸éå•Ÿå‹•å®‰è£å‰ï¼ŒèˆŠç‰ˆç¨‹å¼é‚„æ˜¯è¦å…ˆé—œé–‰æ‰è¡Œã€‚\nå®‰è£å®Œæˆå¾Œè‡ªå‹•å•Ÿå‹•ç¨‹å¼ åœ¨ MyExeProject çš„ Installer Class åŠ ä¸Šä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  [RunInstaller(true)] public partial class ProgramInstaller : Installer { public ProgramInstaller() { InitializeComponent(); this.Committed += new InstallEventHandler(InstallerCommitted);  } private void InstallerCommitted(object sender, InstallEventArgs e) { ProcessStartInfo startInfo = new ProcessStartInfo(); startInfo.FileName = this.Context.Parameters[\u0026#34;assemblypath\u0026#34;]; startInfo.Arguments = \u0026#34;\u0026#34;;  Process.Start(startInfo); } }   ä»¥ä¸Šæ–¹å¼å•Ÿå‹•åŸ·è¡Œæª”æ™‚ï¼Œæœƒæ˜¯åŸ·è¡Œå®‰è£æ™‚çš„æ¬Šé™ï¼ˆç³»çµ±ç®¡ç†å“¡ï¼‰ï¼Œå¦‚æœéœ€è¦å›å¾©åˆ°ç™»å…¥æ™‚çš„æ¬Šé™ä¾†å•Ÿå‹•åŸ·è¡Œæª”ï¼Œå¯ä»¥æ”¹ç‚ºï¼š\n1 2 3 4 5 6 7  private void InstallerCommitted(object sender, InstallEventArgs e) { ProcessStartInfo startInfo = new ProcessStartInfo(); startInfo.FileName = \u0026#34;explorer.exe\u0026#34;; startInfo.Arguments = this.Context.Parameters[\u0026#34;assemblypath\u0026#34;];  Process.Start(startInfo); }   æ¯”è¼ƒå›°æ“¾çš„æ˜¯ï¼Œç¨‹å¼ç„¡æ³•åœ¨å®‰è£ç¨‹åºæœ€å¾Œä¸€å€‹ç•«é¢é—œé–‰å¾Œæ‰å•Ÿå‹•ï¼Œè€Œæ˜¯åœ¨å®‰è£é€²åº¦æ¢è·‘å®Œå¾Œå°±å•Ÿå‹•ã€‚ä¸çŸ¥é“æœ‰æ²’æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿ\nç™»å…¥ç³»çµ±å¾Œè‡ªå‹•å•Ÿå‹•ç¨‹å¼ å¦‚æœæ˜¯å¸¸ç”¨çš„ç¨‹å¼ï¼Œå¸Œæœ›åœ¨æ¯æ¬¡ç™»å…¥é›»è…¦å¾Œéƒ½å¯ä»¥è‡ªå‹•å•Ÿå‹•ï¼Œå¯ä»¥åœ¨ç™»éŒ„æª” SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run çš„ä½ç½®æ–°å¢éµå€¼ï¼Œåç¨±å¯ä»»æ„å–ï¼Œå…§å®¹å°±æ˜¯æ”¾åŸ·è¡Œæª”è·¯å¾‘ï¼ˆå¯åŠ ä¸Šå¼•æ•¸ï¼‰ï¼Œä½¿ç”¨è€…ç™»å…¥å¾Œç³»çµ±å°±æœƒåŸ·è¡Œæª”æ¡ˆã€‚\nä¸€æ¨£æ˜¯åœ¨ Committed æ™‚è™•ç†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  [RunInstaller(true)] public partial class ProgramInstaller : Installer { public ProgramInstaller() { InitializeComponent(); this.Committed += new InstallEventHandler(InstallerCommitted); } private void InstallerCommitted(object sender, InstallEventArgs e) { string path = this.Context.Parameters[\u0026#34;assemblypath\u0026#34;]; string keyName = @\u0026#34;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\u0026#34;;  RegistryKey rk = Registry.LocalMachine.CreateSubKey(keyName); rk.SetValue(\u0026#34;MyExeProject\u0026#34;, $\u0026#34;\\\u0026#34;{path}\\\u0026#34; -aa -bb\u0026#34;, RegistryValueKind.String);  rk.Close(); } }   å¯¦éš›å¯«åˆ°ç™»éŒ„æª”ç•«é¢ï¼š\n  å¦‚æœæ˜¯ 32 ä½å…ƒç¨‹å¼å®‰è£åˆ° 64 ä½å…ƒç³»çµ±ï¼Œä¸Šè¿°ç¨‹å¼ç¢¼åŸ·è¡Œå¾Œï¼Œå¯¦éš›ç™»éŒ„æª”æœƒå¯«åœ¨ SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\n ä¾ç…§éœ€æ±‚ï¼Œå¯ä»¥è¨­å®šåœ¨ Local Machine å±¤ç´šæˆ–æ˜¯ Current User ä¸Šï¼Œå¦‚æœå…©å€‹éƒ½è¨­å®šç™»å…¥æ™‚æœƒå•Ÿå‹•å…©æ¬¡ï¼Œå¯èƒ½éœ€è€ƒæ…®ç¨‹å¼æœƒä¸æœƒç”¢ç”Ÿè¡çªã€‚\né™¤äº† Run å¤–ï¼Œé‚„æœ‰ RunOnce ï¼Œåªéœ€è¦åœ¨é‡æ–°é–‹æ©Ÿå¾ŒåŸ·è¡Œä¸€æ¬¡çš„ï¼Œå°±å¯ä»¥æ”¾åˆ° RunOnceï¼ˆå¾®è»Ÿæ–‡ä»¶ï¼‰ã€‚\nå»ºç«‹è‡ªè§£å£“ç¸®æª” é€™å°‡æ‰“åŒ…å£“ç¸®æ•¸å€‹æª”æ¡ˆæˆä¸€å€‹å¯è‡ªå‹•è§£å£“ç¸®çš„åŸ·è¡Œæª”ï¼Œä½¿å…¶åŸ·è¡Œæ™‚è‡ªå‹•è§£å£“ç¸®ï¼ŒåŒæ™‚å•Ÿå‹•è£¡é¢æŸå€‹ exe æª”ã€‚å¯ä»¥ç”¨ä¾†å»ºç«‹å…å®‰è£æª”ï¼ˆå¯æ”œå¼è»Ÿé«”ï¼‰ï¼Œæˆ–è€…å¦‚æœæœ‰ç”¨åˆ° Setup.exe ä¾†é å…ˆå®‰è£æŸäº›å…ƒä»¶æ™‚ï¼Œä¹Ÿå¯ä»¥ç”¨é€™å€‹æŠ€å·§å°‡ Setup.exe å’Œ msi æª”åˆä½µæˆä¸€å€‹æª”æ¡ˆä¾†é‡‹å‡ºã€‚\nåƒè€ƒçš„ä¿å“¥çš„ã€Œå¦‚ä½•åˆ©ç”¨ 7-zip è¨­å®šè‡ªå‹•è§£å£“ç¸®ä¸¦è§£å£“ç¸®å¾Œè‡ªå‹•å•Ÿå‹•ç¨‹å¼ã€å°±å¯ä»¥ç”¢ç”Ÿå…å®‰è£æª”ï¼Œç°¡è¿°æ–¹æ³•å¦‚ä¸‹ï¼š\n åˆ°ã€Œ7-Zip å®˜ç¶²ã€ä¸‹è¼‰ LZMA SDKï¼šç¾åœ¨ SFX æ¨¡çµ„å’Œå…¶ä»–çš„ SDK éƒ½æ¶µè“‹åœ¨ LZMA SDK ä¸­ï¼Œæˆ‘ä¸‹è¼‰çš„æ˜¯ 19.00 ç‰ˆã€‚è§£å£“ç¸® bin åº•ä¸‹çš„ 7zr.exe å’Œ 7zSD.sfxï¼Œå°‡æª”æ¡ˆæ”¾åˆ° MyExeProject çš„ bin åº•ä¸‹ï¼Œæ–¹ä¾¿ä¹‹å¾Œè¦ç›´æ¥åŠ å…¥ Debug æˆ– Release æ•´å€‹è³‡æ–™å¤¾å…§å®¹ã€‚    æ–°å¢æ–‡å­—æª” config.txtï¼Œå…§å®¹åŒ…å«è¨Šæ¯è¦–çª—çš„æ¨™é¡Œï¼ˆTitleï¼‰ã€æç¤ºå…§å®¹ï¼ˆBeginPromptï¼‰ï¼Œè®“ä½¿ç”¨è€…ç¢ºèªå¾Œå†é€²è¡Œè§£å£“ç¸®ï¼Œé‚„æœ‰è§£å£“ç¸®å¾Œè¦åŸ·è¡Œçš„ç¨‹å¼è·¯å¾‘ï¼ˆRunProgramï¼‰ç­‰ã€‚ç¯„ä¾‹å¦‚ä¸‹ï¼š  ;!@Install@!UTF-8! Title=\u0026quot;Zoeyçš„ç¨‹å¼æ—¥å¸¸\u0026quot; BeginPrompt=\u0026quot;æ‚¨è¦åŸ·è¡Œ Zoeyçš„æ¸¬è©¦è»Ÿé«” å—ï¼Ÿ\u0026quot; RunProgram=\u0026quot;Debug\\MyExeProject.exe\u0026quot; ;!@InstallEnd@! å°‡ 7zr.exe å£“ç¸®æª”æ¡ˆåŠç”¢ç”Ÿå¯åŸ·è¡Œæª”çš„æŒ‡ä»¤å¯«æˆæ‰¹æ¬¡æª”ï¼ˆä¾‹å¦‚ SFXDebug.batï¼‰ï¼š  1 2 3 4 5 6 7  REM å°‡è³‡æ–™å¤¾ Debug åŠ å…¥å£“ç¸®æª” (æª”å Debug.7z) 7zr.exe a Debug.7z Debug\\ REM å°‡ä»¥ä¸‹æª”æ¡ˆå¾å£“ç¸®æª”ä¸­ç§»é™¤ 7zr.exe d Debug.7z Debug\\MyExeProject.pdb 7zr.exe d Debug.7z Debug\\*.xml REM åˆ©ç”¨ 7zSD.sfxã€config.txt å’Œå£“ç¸®æª” Debug.7z ç”¢ç”Ÿå¯åŸ·è¡Œæª”ï¼ˆæª”å Debug.exeï¼‰ copy /b 7zSD.sfx + config.txt + Debug.7z Debug.exe   åœ¨ MyExeProject å°ˆæ¡ˆçš„ã€Œå»ºç½®å¾Œäº‹ä»¶ã€åŠ ä¸ŠæŒ‡ä»¤åŸ·è¡Œæ‰¹æ¬¡æª”ï¼Œåƒè€ƒå¦‚ä¸‹ï¼š  1 2 3 4 5 6  if \u0026#34;$(ConfigurationName)\u0026#34; == \u0026#34;Debug\u0026#34; ( cd \u0026#34;$(ProjectDir)bin\u0026#34; SFXDebug.bat ) else ( REM ç•¥... )   è€Œåœ¨å»ºç«‹å…å®‰è£æª”éç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°çš„ç‹€æ³æ˜¯ï¼Œå› ç‚ºè»Ÿé«”æœ¬èº«ä¸éœ€è¦ä»¥ç³»çµ±ç®¡ç†å“¡æ¬Šé™åŸ·è¡Œï¼Œä½†æ˜¯ä½¿ç”¨ 7-Zip çš„ 7zSD.sfx æª”ï¼Œæœƒéœ€è¦ç³»çµ±ç®¡ç†å“¡æ¬Šé™ï¼Œæ‰€ä»¥éœ€è¦å°‡ä¸‹è¼‰çš„ SFX æª”é€²è¡Œæ”¹é€ ï¼Œæ‰èƒ½åœ¨ä¸é ˆæé«˜æ¬Šé™ä¸‹å°±èƒ½åŸ·è¡Œã€‚\n7zSD.sfx æª”æ¡ˆæ”¹é€ æ–¹å¼ï¼š\n æ–°å¢ manifest.xmlï¼Œèˆ‡ 7zSD.sfx æ”¾åœ¨åŒä¸€ç›®éŒ„ä¸‹ï¼Œå…§å®¹ç‚ºï¼š  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;assembly manifestVersion=\u0026#34;1.0\u0026#34; xmlns=\u0026#34;urn:schemas-microsoft-com:asm.v1\u0026#34;\u0026gt; \u0026lt;assemblyIdentity version=\u0026#34;1.0.0.0\u0026#34; name=\u0026#34;MyApplication.app\u0026#34;/\u0026gt; \u0026lt;trustInfo xmlns=\u0026#34;urn:schemas-microsoft-com:asm.v2\u0026#34;\u0026gt; \u0026lt;security\u0026gt; \u0026lt;requestedPrivileges xmlns=\u0026#34;urn:schemas-microsoft-com:asm.v3\u0026#34;\u0026gt; \u0026lt;requestedExecutionLevel level=\u0026#34;asInvoker\u0026#34; uiAccess=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;/requestedPrivileges\u0026gt; \u0026lt;/security\u0026gt; \u0026lt;/trustInfo\u0026gt; \u0026lt;compatibility xmlns=\u0026#34;urn:schemas-microsoft-com:compatibility.v1\u0026#34;\u0026gt; \u0026lt;application\u0026gt; \u0026lt;!-- Windows Vista --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{e2011457-1546-43c5-a5fe-008deee3d3f0}\u0026#34; /\u0026gt; \u0026lt;!-- Windows 7 --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\u0026#34; /\u0026gt; \u0026lt;!-- Windows 8 --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\u0026#34; /\u0026gt; \u0026lt;!-- Windows 8.1 --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{1f676c76-80e1-4239-95bb-83d0f6d0da78}\u0026#34; /\u0026gt; \u0026lt;!-- Windows 10 --\u0026gt; \u0026lt;supportedOS Id=\u0026#34;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\u0026#34; /\u0026gt; \u0026lt;/application\u0026gt; \u0026lt;/compatibility\u0026gt; \u0026lt;/assembly\u0026gt;   å‡è¨­æ˜¯ç”¨ Visual Studio 2019 é€²è¡Œé–‹ç™¼ï¼Œä»¥å‘½ä»¤æç¤ºå­—å…ƒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š  1 2  call \u0026#34;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Community\\VC\\Auxiliary\\Build\\vcvarsall.bat\u0026#34; x86 mt.exe -manifest manifest.xml -outputresource:\u0026#34;7zSD.sfx;#1\u0026#34;   7zSD.sfx å³ä¿®æ”¹å®Œæˆã€‚\n å¯åŸ·è¡Œæª”è‡ªè§£å£“ç¸®å¾Œï¼Œæª”æ¡ˆæœƒæš«å­˜åœ¨ %USERPROFILE%\\AppData\\Local\\Temp ç›®éŒ„ä¸‹ï¼Œä»¥ 7zS é–‹é ­å…± 11 ç¢¼çš„è³‡æ–™å¤¾ä¸­ï¼ˆä¾‹å¦‚ï¼š7zSC6918AEEï¼‰ã€‚\n å®‰è£å¾Œç„¡æ³•è§£é™¤å®‰è£ç¨‹å¼ æœ‰å˜—è©¦éæ”¹é€ å»ºç½®å¥½çš„ msi æª”ï¼Œçµæœå®‰è£å®Œå¾Œå»ç„¡æ³•è§£é™¤å®‰è£ï¼Œå¹¸å¥½ç¶²è·¯ä¸Šæ‰¾åˆ°äº†ä¸€å€‹æ–¹æ³•å¯ä»¥è™•ç†é€™å€‹ç‹€æ³ï¼ˆé™¤äº†ç”¨ç¾æœ‰çš„å¼·åˆ¶ç§»é™¤å®‰è£è»Ÿé«”å¤–ï¼‰ï¼Œä¹Ÿé †ä¾¿ç­è§£äº† Windows ç³»çµ±å¦‚ä½•è¨˜éŒ„ã€Œæ–°å¢ç§»é™¤ç¨‹å¼ã€ï¼ˆæˆ–ã€Œç¨‹å¼å’ŒåŠŸèƒ½ã€ï¼‰æ¸…å–®ã€‚\n ä»¥ä¸‹ç‰½æ¶‰åˆ°ç™»éŒ„æª”çš„æ“ä½œï¼Œè«‹è¬¹æ…å°å¿ƒæ³¨æ„ï¼\n  å®‰è£ç¨‹å¼çš„è³‡è¨Šè¨˜éŒ„åœ¨ HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\ æˆ– WOW6432Node çš„ç›¸å°è·¯å¾‘çš„ç™»éŒ„æª”ä¸­ï¼Œå„è»Ÿé«”çš„æ©Ÿç¢¼å¯èƒ½ä»¥ GUID æˆ–è»Ÿé«”åç¨±å‘ˆç¾ï¼Œå„å€‹æ©Ÿç¢¼ä¸‹å¯æ‰¾åˆ°éµå€¼ DisplayName å°±æ˜¯é¡¯ç¤ºåœ¨æ¸…å–®ä¸Šçš„åç¨±ï¼ŒDisplayVersion æ˜¯è»Ÿé«”ç‰ˆæœ¬ç­‰ã€‚  ä¾‹å¦‚ Microsoft SQL Server 2017 Setup åœ¨æ‡‰ç”¨ç¨‹å¼æ¸…å–®ç•«é¢ç‚ºï¼ˆWindows 10ï¼‰ï¼š\n ç™»éŒ„æª”è³‡è¨Šç‚ºï¼š\n åœ¨æ¸…å–®ä½¿ç”¨ã€Œä¿®æ”¹ã€æˆ–ã€Œè§£é™¤å®‰è£ã€åŠŸèƒ½æ™‚ï¼Œå°±æ˜¯åˆ†åˆ¥åŸ·è¡Œéµå€¼ ModifyPath æˆ– UninstallString æ‰€å­˜çš„æŒ‡ä»¤ã€‚\nä»¥ Setup Project å°ˆæ¡ˆè£½ä½œçš„å®‰è£æª”ï¼Œå®‰è£å¾Œå…¶è·¯å¾‘æ©Ÿç¢¼ GUID å°±æ˜¯å±¬æ€§ä¸­çš„ ProductCodeï¼ŒProductName ç‚º DisplayNameï¼ŒVersion ç‚º DisplayVersionï¼ŒAuthor ç‚º Contactï¼ŒManufacturer ç‚º Publisher ç­‰ã€‚\n åœ¨æ­¤å¯ä»¥å°‡æ¬²ç§»é™¤çš„è»Ÿé«”çš„æ©Ÿç¢¼å«å­æ©Ÿç¢¼æ•´å€‹åˆªé™¤ï¼Œé€™æ™‚åœ¨æ‡‰ç”¨ç¨‹å¼æ¸…å–®ä¸­å°±ä¸æœƒå†å‡ºç¾é€™å€‹è»Ÿé«”ã€‚\nä¾‹å¦‚å°‡ HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{GUIDXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX} åˆªé™¤\n æ¥ä¸‹ä¾†å°‡ä¸Šè¿°çš„ GUID é‡çµ„ï¼Œä»¥ - åšç‚ºå€éš”ï¼Œå‰ä¸‰å€‹éƒ¨ä»½å­—ä¸²é€²è¡Œåè½‰ï¼Œå¾Œå…©å€‹éƒ¨åˆ†æ¯å…©å€‹å­—ç¬¦é †åºèª¿æ›ï¼Œä¾‹å¦‚ {0D86D25D-AE80-43EE-B977-9858CA9FD43E} æœƒé‡çµ„æˆ {D52D68D0-08EA-EE34-9B77-8985ACF94DE3}ï¼Œç„¶å¾Œå»é™¤ç¬¦è™Ÿéƒ¨åˆ†ï¼ŒD52D68D008EAEE349B778985ACF94DE3ã€‚  åˆ°å¦å¤–ä¸€å€‹ç™»éŒ„æª”è·¯å¾‘ HKLM\\SOFTWARE\\Classes\\Installer\\Products æ‰¾åˆ°é€™å€‹é‡çµ„çš„æ©Ÿç¢¼ï¼ˆä¸é ˆè½‰æ›åˆ° WOW6432Nodeï¼‰ï¼Œæ¯”å° ProductName ç„¡èª¤ï¼Œå³å¯åˆªé™¤æ­¤æ©Ÿç¢¼ã€‚\nåƒè€ƒ Microsoft SQL Server 2017 Setup åœ¨æ­¤çš„ç™»éŒ„æª”è³‡è¨Šç‚ºï¼š\n æœ€å¾Œåˆªé™¤æ­¤ç¨‹å¼åŸ·è¡Œæª”ç›®éŒ„ï¼ˆä¾‹å¦‚ C:\\Program Files (x86)\\MyExeProjectï¼‰ï¼Œå®Œæˆæ•´å€‹è»Ÿé«”çš„ç§»é™¤ã€‚\nç•¶ç„¶ï¼Œå¦‚æœé€™å€‹è»Ÿé«”å®‰è£æ™‚æœ‰å¯«ç™»éŒ„æª”æˆ–å»ºç«‹æ·å¾‘çš„è©±ï¼Œå°±è¦å¦å¤–åˆªé™¤ã€‚\nä»¥ä¸Šç‚ºå»ºç«‹å®‰è£æª”æ™‚å¯èƒ½ç”¨åˆ°çš„å°æŠ€å·§ï¼Œèˆ‡ä½ åˆ†äº«ğŸ˜\nç›¸é—œé€£çµï¼š  [VITOã®å­¸ç¿’ç­†è¨˜] å»ºç«‹Installer åœ¨Visual Studioå°‡Windows Serviceæ‰“åŒ…æˆå®‰è£æª” [stack overflow] Installer won\u0026rsquo;t overwrite existing app [CODE PROJECT] Launching Your Application After Install using Visual Studio 2005 [Micorsoft Docs] Run and RunOnce Registry Keys [WILLä¿å“¥] å¦‚ä½•åˆ©ç”¨ 7-zip è¨­å®šè‡ªå‹•è§£å£“ç¸®ä¸¦è§£å£“ç¸®å¾Œè‡ªå‹•å•Ÿå‹•ç¨‹å¼ 7-Zip SDK [stack overflow] 7zip Self Extracting Archive (SFX) without administrator privileges [StackExchange] How to force uninstall a software that is installed by MSI package?  ","description":"æœ¬ç¯‡æ•´ç†ä½¿ç”¨ Visual Studio Installer ä¾†å»ºç«‹å®‰è£æª”çš„ä¸€äº›å°æŠ€å·§åŠå…å®‰è£æª”æˆ–è‡ªè§£å£“ç¸®æª”çš„å»ºç½®ã€‚","id":1,"section":"posts","tags":["visual studio","installer","setup project","portableware","self extracting archives"],"title":"Visual Studio Installer Projects - å®‰è£æª”äºŒä¸‰äº‹","uri":"https://www.zoeydc.com/zh/posts/2021-08-25-about_installer/"},{"content":"æœ€è¿‘åœ¨ç”¨ struct æ™‚ä¸€ç›´æœ‰äº›ç–‘æ…®ï¼Œæ±ºå®šé‚„æ˜¯å°‡é€™éƒ¨åˆ†å¥½å¥½å¼„æ¸…æ¥šï¼Œæ‰€ä»¥å°±æ•´ç†äº†é€™ç¯‡ç­†è¨˜ï¼Œè¨˜éŒ„ .NETã€Œé€šç”¨èªè¨€é‹è¡Œåº«ã€ï¼ˆCLRï¼›Common Language Runtimeï¼‰å¦‚ä½•ç®¡ç†å’Œé…ç½®è¨˜æ†¶é«”è³‡æºï¼Œä¾†å­˜å–ç¨‹å¼é‹è¡Œä¸­ç”¨åˆ°çš„å¯¦å€¼å‹åˆ¥ï¼ˆvalue typesï¼‰æˆ–åƒè€ƒå‹åˆ¥ï¼ˆreference typesï¼‰è®Šæ•¸è³‡æ–™ã€‚\n.NET å’Œ CLR ç°¡å–®è€Œè¨€ï¼ŒCLR å°±æ˜¯è®“ .NET æ‡‰ç”¨ç¨‹å¼å¯ä»¥é‹ä½œçš„è™›æ“¬æ©Ÿå™¨ã€‚\nä¸åŒ .NET èªè¨€çš„ä¾†æºç¨‹å¼ç¢¼ï¼Œè¢«å„è‡ªçš„ç·¨è­¯å™¨ç·¨è­¯å¾Œï¼Œéƒ½æœƒç·¨è­¯æˆ CILï¼ˆé€šç”¨ä¸­é–“èªè¨€ï¼‰ç¨‹å¼ç¢¼ï¼Œå„²å­˜åœ¨äºŒé€²åˆ¶æª”æ¡ˆï¼ˆ.exe/.dllï¼‰ä¸­ã€‚ç•¶äºŒé€²åˆ¶æª”æ¡ˆè¢«åŸ·è¡Œæ™‚ï¼ŒCLR æ‰æœƒå°‡ CIL å³æ™‚ç·¨è­¯æˆé©ç”¨æ–¼è©²ç³»çµ±ç’°å¢ƒçš„æ©Ÿå™¨ç¨‹å¼ç¢¼ï¼›åŒæ™‚ CLR ä¹Ÿç®¡ç†å’Œä½œæ¥­ç³»çµ±æºé€šèˆ‡å®‰å…¨æ€§å•é¡Œç­‰è«¸å¤šäº‹é …ï¼Œè€Œè¨˜æ†¶é«”ç®¡ç†å°±æ˜¯å…¶ä¸­ä¸€é …ã€‚\n å› ç‚º .NET ç¨‹å¼éœ€è¦ä¾é  CLR ä¾†é‹è¡Œï¼Œæ˜¯å— CLR æ‰€ç®¡æ§ï¼Œæ‰€ä»¥ä¹Ÿå°‡é€™äº›ç¨±ç‚ºå—æ§ç¨‹å¼ç¢¼ï¼ˆmanaged codeï¼‰ï¼›ä½†å¦‚æœæ˜¯ C/C++ ç¨‹å¼ï¼Œæ‰€æœ‰å’Œç³»çµ±ç’°å¢ƒçš„æºé€šéƒ½æ˜¯ç”±ç¨‹å¼ç¢¼è‡ªå·±è™•ç†ï¼Œæ•…ç¨±ç‚ºéå—æ§ç¨‹å¼ç¢¼ï¼ˆunmanaged codeï¼‰ã€‚\nè¨˜æ†¶é«”ç®¡ç† .NET ç¨‹å¼åŸ·è¡Œæ™‚ï¼ŒCLR æœƒä¿ç•™ä¸€å¡Šé€£çºŒçš„è¨˜æ†¶é«”ç©ºé–“ä¾›ç¨‹å¼ä½¿ç”¨ï¼ˆä¸å—å…¶ä»–ç¨‹å¼å¹²æ“¾ï¼‰ï¼Œé€™å€‹è¨˜æ†¶é«”ç©ºé–“å°‡åŠƒåˆ†ç‚ºå¤šå€‹å€åŸŸï¼šHigh Frequency Heapã€Stackã€GC Heapã€Large Object Heap ç­‰ï¼Œä¸€èˆ¬ Heap æŒ‡ GC Heap å’Œ Large Object Heapã€‚\nHigh Frequency Heap   å­˜æ”¾å‹åˆ¥ç‰©ä»¶ï¼ˆType objectï¼‰ï¼šå«å„å‹åˆ¥ä¹‹éœæ…‹æˆå“¡ã€æ–¹æ³•è¡¨ï¼ˆMethod tableï¼›å­˜æ”¾éœæ…‹æ–¹æ³•ã€è™›æ“¬æ–¹æ³•ã€ä¸€èˆ¬æ–¹æ³•çš„æŒ‡æ¨™ï¼‰ç­‰ã€‚ ç¨‹å¼åŸ·è¡ŒæœŸé–“ä¸€ç›´ä½”ç”¨è¨˜æ†¶é«”ç©ºé–“ï¼Œä¸æœƒé‡‹å‡ºã€‚   ç¨‹å¼è¼‰å…¥å¾Œï¼Œæ¯ä¸€æ¬¡é‡åˆ°é‡åˆ°æ–°çš„éœæ…‹æˆå“¡æˆ–æ–¹æ³•ï¼ˆæˆ–è€…æ‰€å±¬é¡åˆ¥çš„ instance ç¬¬ä¸€æ¬¡å»ºç«‹å‰ï¼‰ï¼Œå°±æœƒé…ç½®ä¸€å€‹å€å¡Šå­˜æ”¾æ­¤å‹åˆ¥ç‰©ä»¶ã€‚é€™åœ¨ç¨‹å¼åŸ·è¡ŒæœŸé–“åªæœƒé…ç½®é€™éº¼ä¸€æ¬¡ï¼Œä¹‹å¾Œå°±ä¸€ç›´å ç”¨åŒæ¨£çš„è¨˜æ†¶é«”ä½å€ï¼Œç›´åˆ°ç¨‹å¼çµæŸæ‰æœƒé‡‹å‡ºï¼›ç•¶éœæ…‹æˆå“¡æˆ–æ–¹æ³•å¤šæ™‚ï¼Œæœƒå ç”¨æ¯”è¼ƒå¤šçš„è¨˜æ†¶é«”ç©ºé–“ã€‚\nStackï¼ˆå †ç–Šï¼‰   å­˜æ”¾å€åŸŸè®Šæ•¸ï¼Œå¦‚æœè®Šæ•¸ç‚ºå¯¦å€¼å‹åˆ¥ï¼Œå…¶å€¼ä¹Ÿå­˜æ”¾åœ¨ Stack ä¸­ï¼Œå¦‚æœè®Šæ•¸ç‚ºåƒè€ƒå‹åˆ¥ï¼Œå…¶æŒ‡æ¨™ï¼ˆPointerï¼›Heap è¨˜æ†¶é«”ä½å€ï¼‰å­˜æ”¾åœ¨ Stack ä¸­ã€‚ è®Šæ•¸å®£å‘Šå¾Œé–‹å§‹å ç”¨è¨˜æ†¶é«”ï¼Œé›¢é–‹è®Šæ•¸å¯è¦‹ç¯„åœå®Œæˆç”Ÿå‘½é€±æœŸå¾Œï¼Œè¨˜æ†¶é«”ç©ºé–“è‡ªå‹•å›æ”¶ã€‚   Stack æ˜¯ä»¥ã€Œå¾Œé€²å…ˆå‡ºã€çš„é™£åˆ—çµæ§‹ä¾†å­˜å–è³‡æ–™ã€‚éš¨è‘—ç¨‹å¼åŸ·è¡Œç·’æ–¹å‘å‰é€²ï¼Œæ¯å®£å‘Šä¸€å€‹å€åŸŸè®Šæ•¸æ™‚ï¼Œé€™å€‹è®Šæ•¸å°±æœƒåœ¨ Stack ä¸­ã€Œå †ç–Šã€ï¼Œè€Œåœ¨é›¢é–‹å‡½å¼è®Šæ•¸ä¸å†ä½¿ç”¨å¾Œï¼Œè¨˜æ†¶é«”ç©ºé–“æœƒè‡ªå‹•é‡‹æ”¾ã€‚æ‰€ä»¥å…ˆå®£å‘Šçš„è®Šæ•¸çš„è¨˜æ†¶é«”ç©ºé–“æœƒæœ€å¾Œé‡‹æ”¾ï¼Œæœ€å¾Œå®£å‘Šçš„è®Šæ•¸æœƒæœ€å…ˆå›æ”¶ï¼ˆLast In, First Outï¼›LIFOï¼‰ã€‚å„²å­˜åœ¨ Stack çš„è³‡æ–™å…¶ç”Ÿå‘½é€±æœŸæ˜¯å¯ä»¥é æ¸¬çš„ï¼Œä¸é ˆç‰¹æ„ç®¡ç†è¨˜æ†¶é«”çš„é‡‹æ”¾ã€‚\nä½†å› ç‚ºè¨˜æ†¶é«”ç©ºé–“æ˜¯æœ‰é™çš„ï¼Œç¨‹å¼æ²’æœ‰å¯«å¥½è€Œé€ æˆç„¡é™è¿´åœˆæˆ–ç„¡é™éè¿´æ™‚ï¼ŒStack ç©ºé–“ä¸è¶³æœƒç™¼ç”Ÿæº¢ä½éŒ¯èª¤ï¼ˆStackOverflowExceptionï¼‰ã€‚\nHeapï¼ˆå †ç©ï¼‰- GC Heap \u0026amp; Large Object Heap   å­˜æ”¾åƒè€ƒå‹åˆ¥è®Šæ•¸çš„å€¼ï¼ˆç‰©ä»¶æœ¬èº«ï¼‰å’Œå°ç®±çš„ï¼ˆBoxedï¼‰å¯¦å€¼å‹åˆ¥ç‰©ä»¶ç­‰ã€‚ ç•¶åƒè€ƒå‹åˆ¥çš„ç‰©ä»¶å»ºç«‹æ™‚ï¼Œé–‹å§‹å ç”¨è¨˜æ†¶é«”ï¼Œç›´åˆ°ç©ºé–“ä¸è¶³æ™‚ GC é‡‹æ”¾æ²’æœ‰æŒ‡æ¨™æŒ‡å‘çš„ç‰©ä»¶ã€‚ç„¡æ³•é æ¸¬ç”Ÿå‘½é€±æœŸã€‚   .NET ä¸­é€™å€‹å€å¡Šç”± Garbage Collectorï¼ˆGCï¼›åƒåœ¾å›æ”¶ï¼›è¨˜æ†¶é«”å›æ”¶ï¼‰ä¾†æä¾›è‡ªå‹•è¨˜æ†¶é«”ç®¡ç†æœå‹™ã€‚è‡ªå‹•è¨˜æ†¶é«”ç®¡ç†ï¼ˆAutomatic Memory Managementï¼‰å¯ä»¥é¿å…ä¸€äº›å¸¸è¦‹çš„å•é¡Œï¼Œä¾‹å¦‚å¿˜è¨˜é‡‹æ”¾ä¸å†ä½¿ç”¨çš„ç‰©ä»¶è€Œé€ æˆè¨˜æ†¶é«”æµå¤±ï¼ˆMemory Leakï¼Œä¹Ÿå°±æ˜¯ Stack ä¸­çš„è®Šæ•¸å’ŒæŒ‡æ¨™å·²ç¶“ç§»é™¤äº†ï¼Œä½† Heap ä¸­è®Šæ•¸å°æ‡‰çš„ç‰©ä»¶æ²’æœ‰è¢«é‡‹æ”¾ï¼‰ï¼Œæˆ–å˜—è©¦å­˜å–å·²ç¶“è¢«é‡‹æ”¾çš„ç‰©ä»¶è€Œé€ æˆéŒ¯èª¤ç­‰ã€‚\nç•¶ç¬¬ä¸€å€‹åƒè€ƒå‹åˆ¥çš„å¯¦ä¾‹å»ºç«‹ï¼ˆnewï¼‰æ™‚ï¼ŒGC æœƒä¾æ“šæ‰€éœ€çš„è¨˜æ†¶é«”å¤§å°åœ¨ GC Heap æ ¹ä½å€ï¼ˆbase addressï¼‰ä¸Šé–‹é—¢ä¸€å€‹ç©ºé–“å­˜æ”¾ç‰©ä»¶ï¼Œæ¥ä¸‹ä¾†ä¸‹ä¸€å€‹ç‰©ä»¶çš„å­˜æ”¾ä½ç½®æœƒèˆ‡ä¸Šä¸€å€‹ç›¸é„°ï¼Œä¸‹ä¸€å€‹å†èˆ‡ä¸Šä¸€å€‹ç›¸é„°\u0026hellip;ï¼Œä¾ç…§é€™å€‹åŸå‰‡ä¾åºå­˜æ”¾ç›´åˆ°æ²’æœ‰è¶³å¤ çš„ç©ºé–“ç‚ºæ­¢ã€‚\nç•¶ GC ä¼°è¨ˆè¨˜æ†¶é«”ç©ºé–“ä¸è¶³æ™‚ï¼Œå°±æœƒå°‡ä¸å†ä½¿ç”¨ã€æ²’æœ‰æŒ‡æ¨™æŒ‡å‘çš„ç‰©ä»¶å›æ”¶ï¼Œé‡‹æ”¾ç©ºé–“ï¼Œç„¶å¾Œå°‡å…·æœ‰æŒ‡æ¨™çš„ç‰©ä»¶é‡æ–°æ’åºå£“ç¸®ï¼ˆä»¥è¤‡è£½åˆªé™¤æ–¹å¼ï¼‰ï¼Œå°‡å¯ç”¨çš„ç©ºé–“æŒªåˆ°ä¸€èµ·ï¼Œä¾›å¾ŒçºŒæ–°å¢çš„ç‰©ä»¶ä½¿ç”¨ã€‚ç¨‹å¼ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ GC.Collect() å»ºè­° GC é€²è¡Œå›æ”¶ï¼ˆä¸ä»£è¡¨ GC æœƒé¦¬ä¸Šè™•ç†ï¼‰ï¼Œä½†é€šå¸¸ä¸éœ€è¦é€™éº¼åšã€‚\né™¤äº† GC Heap å¤–ï¼Œå¦æœ‰ä¸€å€‹å€å¡Šç”¨ä¾†å­˜æ”¾å¤§å‹ç‰©ä»¶ï¼ˆLarge Object Heapï¼‰ï¼Œåœ¨é€™å€‹å€å¡Šä¸­ï¼Œä¸€æ¨£æ˜¯ç”± GC ç®¡æ§è¨˜æ†¶é«”é…ç½®ï¼Œä½†æ˜¯ç•¶å¤§å‹ç‰©ä»¶å›æ”¶å¾Œï¼Œå…¶ä»–çš„ç‰©ä»¶ä¸æœƒé‡æ–°æ’åºï¼Œä»¥é¿å…å¤§å‹ç‰©ä»¶çš„æ¬ç§»é™ä½æ•ˆèƒ½ã€‚\nç•¶ç¨‹å¼å»ºç«‹å¤§å‹é™£åˆ—æˆ–è³‡æ–™é›†åˆï¼ŒCLR ç„¡æ³•ç‚ºä»–å€‘é…ç½®è¶³å¤ çš„é€£çºŒè¨˜æ†¶é«”ç©ºé–“æ™‚ï¼Œæœƒç”¢ç”Ÿ OutOfMemoryException ä¾‹å¤–ç‹€æ³ã€‚æ›´å¤šå¯èƒ½å°è‡´ OutOfMemoryException çš„åŸå› å¯ä»¥åƒè€ƒå¾®è»Ÿæ–‡ä»¶ã€‚\nStack vs Heap    é …ç›® Stack Heap     ç‰¹é» éœæ…‹è¨˜æ†¶é«”é…ç½®ï¼›è¨˜æ†¶é«”é…ç½®æ–¹å¼å…·é€£çºŒæ€§ã€å¯é æ¸¬ å‹•æ…‹è¨˜æ†¶é«”é…ç½®ï¼›ä¾ä½¿ç”¨è€…éœ€æ±‚é…ç½®è¨˜æ†¶é«”ï¼Œç©ºé–“ä¸Šä¸éœ€å…·é€£çºŒæ€§   çµæ§‹ç‰¹æ€§ è¨˜æ†¶é«”é™£åˆ—ï¼›å¾Œé€²å…ˆå‡ºï¼ˆLIFOï¼‰çš„è³‡æ–™çµæ§‹ è¨˜æ†¶é«”å€å¡Šï¼Œä¾éœ€æ±‚åˆ†å‰²å„²å­˜å„ç¨®è³‡æ–™ç‰©ä»¶ï¼Œç‰©ä»¶å­˜å–ä¸å­˜åœ¨é †åºé—œä¿‚   æ¯”å–» ç–Šç›¤å­ï¼Œæœ€å¾Œæ”¾ä¸Šå»çš„æœƒæœ€å…ˆæ‹¿èµ·ä¾†  ç›¸ç‰‡ç‰†ï¼Œç…§ç‰‡å¯ä»»æ„æ‹¿å–æˆ–é‡æ–°æ’åˆ—    å„²å­˜çš„è³‡æ–™ å¯¦å€¼å‹åˆ¥ï¼Œå’Œåƒè€ƒå‹åˆ¥çš„æŒ‡æ¨™ åƒè€ƒå‹åˆ¥çš„å€¼å’Œå°ç®±çš„å¯¦å€¼å‹åˆ¥è®Šæ•¸ç­‰   è¨˜æ†¶é«”é…ç½®é€Ÿåº¦ å¿« è¼ƒæ…¢   å¯å¦æ”¹è®Šå„²å­˜é•·åº¦ ä¸èƒ½ å¯ä»¥   å­˜å–æ€§è³ª ä¸èƒ½è·¨åŸ·è¡Œç·’å­˜å– å¯è·¨åŸ·è¡Œç·’å­˜å–   ä½•æ™‚é‡‹æ”¾ç©ºé–“ï¼ˆç”Ÿå‘½é€±æœŸï¼‰ å€åŸŸè®Šæ•¸é›¢é–‹å­˜å–ç¯„åœå¾Œ æ²’æœ‰æŒ‡æ¨™æŒ‡å‘æ­¤ç‰©ä»¶å¾Œï¼Œç”± GC åˆ¤æ–· Heap ä½¿ç”¨éœ€æ±‚ä¾†è¦åŠƒæ¸…é™¤æ™‚æ©Ÿ   ä¾‹å¤–ç‹€æ³ StackOverflowException OutOfMemoryException    åœ–è§£è³‡æ–™å‹åˆ¥èˆ‡è¨˜æ†¶é«”é…ç½® åŸå‰‡ï¼šå¯¦å€¼å‹åˆ¥çš„å€¼æœƒèˆ‡å°æ‡‰çš„è®Šæ•¸æˆ–æˆå“¡åç¨±å­˜æ”¾ç›¸åŒè¨˜æ†¶é«”ä½ç½®ï¼Œåƒè€ƒå‹åˆ¥çš„å€¼æœƒå­˜åœ¨ Heap ä¸­ï¼Œå„²å­˜å…¶å°æ‡‰è®Šæ•¸æˆ–æˆå“¡åç¨±çš„åœ°æ–¹æœƒæœ‰é€™å€‹å€¼çš„æŒ‡æ¨™ã€‚\nä»¥ä¸‹å…±ç”¨çš„ struct å’Œ class ç¨‹å¼ç¢¼ï¼š\n1 2 3 4 5 6 7 8 9 10 11  struct MyStruct { public int Param { get; set; } public MyClass InnerClass { get; set; } } class MyClass { public int Param { get; set; } public MyStruct InnerStruct { get; set; } }   1. å¯¦å€¼å‹åˆ¥ï¼ˆç°¡å–®å‹åˆ¥ï¼‰å€åŸŸè®Šæ•¸ 1 2 3 4 5 6 7 8 9  int a; a = 10; int b = a; int c = Add(a, b); public int Add(int x, int y) { return x + y; }    2. åƒè€ƒå‹åˆ¥ï¼ˆé¡åˆ¥ï¼‰å€åŸŸè®Šæ•¸ 1 2 3 4 5 6 7 8 9 10 11 12 13 14  MyClass myclass1 = new MyClass() { Param = 10 }; MyClass myclass2 = myclass1; BeNull(myclass1); ModifyClassParamTo50(myclass2); public void BeNull(MyClass s) { s = null; //ä¸æœƒå½±éŸ¿åŸæœ¬çš„ç‰©ä»¶çš„æŒ‡æ¨™ } public void ModifyClassParamTo50(MyClass s) { s.Param = 50; }    3. åƒè€ƒå‹åˆ¥ï¼ˆå­—ä¸²ï¼‰å€åŸŸè®Šæ•¸ 1 2 3 4 5 6 7 8 9 10  string s1 = \u0026#34;ABC\u0026#34;; string s2 = s1; s2 = \u0026#34;XYZ\u0026#34;; string s3 = StringConcatenate(s1, s2); public string StringConcatenate(string x, string y) { x += \u0026#34;@@\u0026#34;; return x + y; }    4. Struct å€åŸŸè®Šæ•¸ï¼ˆå«åƒè€ƒå‹åˆ¥æˆå“¡ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  MyStruct mystruct1 = new MyStruct() { Param = 10 }; MyStruct mystruct2 = new MyStruct() { Param = 10 }; Console.WriteLine(\u0026#34;4-1. mystruct2.Equals(mystruct1)ï¼š\u0026#34; + mystruct2.Equals(mystruct1)); //True  ModifyStructParamTo50(mystruct1); //ä½œç‚ºå¼•æ•¸æœƒè¤‡è£½ä¸€ä»½è³‡æ–™çµ¦æ–¹æ³•ä½¿ç”¨ Console.WriteLine(\u0026#34;4-2. mystruct1.Param = \u0026#34; + mystruct1.Param); //10  MyClass myclass = new MyClass(); mystruct1.InnerClass = myclass; Console.WriteLine(\u0026#34;4-3. mystruct2.Equals(mystruct1)ï¼š\u0026#34; + mystruct2.Equals(mystruct1)); //False mystruct2.InnerClass = myclass; Console.WriteLine(\u0026#34;4-4. mystruct2.Equals(mystruct1)ï¼š\u0026#34; + mystruct2.Equals(mystruct1)); //True  ModifyClassParamTo50(mystruct2.InnerClass); Console.WriteLine(\u0026#34;4-5. mystruct1.InnerClass.Param = \u0026#34; + mystruct1.InnerClass.Param); //50 Console.WriteLine(\u0026#34;4-6. mystruct2.Equals(mystruct1)ï¼š\u0026#34; + mystruct2.Equals(mystruct1)); //True Console.WriteLine(\u0026#34;4-7. myclass.Equals(mystruct1.InnerClass)ï¼š\u0026#34; + myclass.Equals(mystruct1.InnerClass)); //True  public void ModifyStructParamTo50(MyStruct s) { s.Param = 50; //ä¿®æ”¹è¤‡è£½ä¾†çš„è³‡æ–™ï¼Œä¸å½±éŸ¿åŸæœ¬ Struct çš„å€¼ } public void ModifyClassParamTo50(MyClass s) { s.Param = 50; }    5. åƒè€ƒå‹åˆ¥å€åŸŸè®Šæ•¸ï¼ˆå« Struct æˆå“¡ï¼‰ 1 2 3  MyClass myClass1 = new MyClass() { Param = 10, InnerStruct = new MyStruct() }; MyClass myClass2 = new MyClass() { Param = 10, InnerStruct = new MyStruct() }; Console.WriteLine(\u0026#34;5-1. myClass2.Equals(myClass1)ï¼š\u0026#34; + myClass2.Equals(myClass1)); //False    6. å¯¦å€¼å‹åˆ¥å°ç®± Boxing 1 2  MyStruct myStruct = new MyStruct(); object boxed = myStruct;    7. é¡åˆ¥é™£åˆ— 1  MyClass[] classArray = new MyClass[] { new MyClass(), new MyClass()};    8. Struct é™£åˆ— 1  MyStruct[] structArray = new MyStruct[] { new MyStruct(), new MyStruct()};    ç¸½çµï¼šStruct ä½¿ç”¨æ™‚æ©Ÿ å’Œ class æ¯”è¼ƒï¼Œå…¶å¯¦ struct çš„é™åˆ¶é —å¤šï¼Œé™¤äº†ä½œç‚ºå¯¦å€¼å‹åˆ¥éœ€è€ƒé‡å…¶è¨˜æ†¶é«”çš„ä½¿ç”¨å¤–ï¼Œå…¶ä»–é‚„æœ‰ struct åªèƒ½å¯¦ä½œä»‹é¢ï¼Œä¸èƒ½ç¹¼æ‰¿æˆ–æŠ½è±¡åŒ–ï¼Œæ‰€ä»¥åªæœ‰æœ‰é™çš„å¤šå‹æ€§ã€‚\næ­¸ç´å…¶ä½¿ç”¨çš„æ™‚æ©Ÿå¦‚ä¸‹ï¼š\n  å°å‹è³‡æ–™çµæ§‹ï¼Œä¸”å…·æœ‰å¯¦å€¼èªæ„ï¼ˆä¾‹å¦‚åº§æ¨™XYï¼‰ é¡åˆ¥ä¸­å¸Œæœ›é™å®šåªèƒ½å”¯è®€çš„æˆå“¡ ä½œç‚ºæ–¹æ³•å¼•æ•¸ï¼Œä½†ä¸å¸Œæœ›å€¼æœ¬èº«å—æ–¹æ³•é‹ç®—çµæœå½±éŸ¿ æ‡‰ç›¡é‡é¿å… Boxing / Unboxing å¦‚æœç„¡æ³•ç¢ºå®šï¼Œå°±é‚„æ˜¯ç”¨ class   ç›¸é—œé€£çµï¼š  [C#Corner] Stack Vs Heap Memory - C# [C#Corner] Working With Static In C# [CODE PROJECT] Static Keyword Demystified [stack overflow] Where are all the static members stored? [Microsoft Docs] Automatic Memory Management [Microsoft Docs] C# å‹åˆ¥ç³»çµ±  [Microsoft Docs] Structs Struct V.S Class å…©è€…ä¹‹é–“å·®ç•° Why is List 15 Times Faster to Allocate than List in C# [Book] Head First C#, 4th Edition  ","description":"ç°¡å–®æ•´ç† .NETã€Œé€šç”¨èªè¨€é‹è¡Œåº«ã€ï¼ˆCommon Language Runtimeï¼‰å¦‚ä½•ç®¡ç†å’Œé…ç½®è¨˜æ†¶é«”è³‡æºï¼Œä»¥å­˜å–ç¨‹å¼é‹è¡Œä¸­æ‰€ç”¨çš„å¯¦å€¼å‹åˆ¥ï¼ˆvalue typesï¼‰æˆ–åƒè€ƒå‹åˆ¥ï¼ˆreference typesï¼‰è®Šæ•¸è³‡æ–™ã€‚","id":2,"section":"posts","tags":["CLR","stack","heap","value types","reference types","struct"],"title":"CLRã€è¨˜æ†¶é«”ç®¡ç†èˆ‡è³‡æ–™å‹åˆ¥","uri":"https://www.zoeydc.com/zh/posts/2021-07-10-clr_stack_heap_csharp_types/"},{"content":"æœ‰æ™‚å¾Œé–‹ç™¼ä¸­éœ€è¦æ¸¬è©¦ä¸åŒç’°å¢ƒæˆ–è£ç½®é–‹å•Ÿç¶²ç«™çš„å·®ç•°ï¼Œè€Œç‚ºäº†æ–¹ä¾¿åµéŒ¯ï¼Œå¯ä»¥è®“ IIS Express å•Ÿå‹•çš„ç¶²ç«™å…è¨±å¤–éƒ¨é€£ç·šé€²ä¾†ã€‚\nâ¼€ã€ç³»çµ±ç’°å¢ƒ  Windows Server 2012 Visual Studio 2012  äºŒã€å–å¾—æœ¬æ©Ÿç«¯ IP ä»¥ ipconfig å–å¾—æœ¬æ©Ÿç«¯çš„ IPï¼ˆä¾‹å¦‚ 192.168.40.1ï¼‰\nä¸‰ã€ä»¥ç³»çµ±ç®¡ç†å“¡â¾åˆ†é–‹å•Ÿ Visual Studio ä¸€å®šè¦ç”¨ç³»çµ±ç®¡ç†å“¡â¾åˆ†åŸ·â¾ Visual Studioï¼Œå› ç‚ºæ›´æ”¹æˆé localhost çš„ç¹«çµè¨­å®šå¾Œéœ€è¦ç³»çµ±ç®¡ç†å“¡æ¬Šé™æ‰èƒ½åŸ·â¾ IIS Expressã€‚\nå¦‚æœæ²’æœ‰ç”¨ç³»çµ±ç®¡ç†å“¡åŸ·è¡Œï¼Œå¯èƒ½æœƒè·³å‡ºä»¥ä¸‹è¨Šæ¯ï¼š\n å››ã€è¨­å®š applicationhost.config é–‹å§‹åµéŒ¯ï¼ŒIIS ExpressåŸ·â¾å¾Œï¼Œå–å¾—ç¶²ç«™åç¨±ï¼Œä¸¦æ‰¾åˆ°çµ„æ…‹æª” applicationhost.configã€‚\n   ï¼ˆVS 2012 åœ¨ã€Œæˆ‘çš„æ–‡ä»¶ã€ä¸­ï¼šã€Œ%USERPROFILE%\\My Documents\\IISExpress\\config\\applicationhost.configã€ï¼›VS 2019 åœ¨ã€Œâ½…æ¡ˆè³‡æ–™å¤¾.vs\\å°ˆæ¡ˆåç¨±\\config\\applicationhost.configã€ã€‚ï¼‰\n é–‹å•Ÿæª”æ¡ˆå¾Œï¼Œä¾ç…§ç¶²ç«™åç¨±æ‰¾åˆ°å°æ‡‰çš„è¨­å®šï¼Œä¿®æ”¹åŸæœ¬çš„ç¹«çµè¨­å®šï¼Œå°‡ localhost æ”¹æˆæœ¬æ©Ÿçš„ IPï¼ˆä¾‹å¦‚ bindingInformation=\u0026quot;*:62754:localhost\u0026quot; æ”¹ç‚º bindingInformation=\u0026quot;*:62754:192.168.40.1\u0026quot;ï¼‰ï¼Œç„¶å¾Œå­˜æª”ã€‚\n1 2 3 4 5 6 7 8 9  \u0026lt;site name=\u0026#34;TestSite(1)\u0026#34; id=\u0026#34;3\u0026#34;\u0026gt; \u0026lt;application path=\u0026#34;/\u0026#34; applicationPool=\u0026#34;Clr4IntegratedAppPool\u0026#34;\u0026gt; \u0026lt;virtualDirectory path=\u0026#34;/\u0026#34; physicalPath=\u0026#34;C:\\TestSite\\TestSite\u0026#34; /\u0026gt; \u0026lt;/application\u0026gt; \u0026lt;bindings\u0026gt; \u0026lt;binding protocol=\u0026#34;http\u0026#34; bindingInformation=\u0026#34;*:62754:192.168.40.1\u0026#34; /\u0026gt; \u0026lt;binding protocol=\u0026#34;https\u0026#34; bindingInformation=\u0026#34;*:44372:192.168.40.1\u0026#34; /\u0026gt;  \u0026lt;/bindings\u0026gt; \u0026lt;/site\u0026gt;   äº”ã€è¨­å®šè¼¸å…¥è¦å‰‡ æ§åˆ¶å°â†’Windowsé˜²ç«ç‰†â†’é€²éšè¨­å®šâ†’è¼¸å…¥è¦å‰‡â†’æ–°å¢è¦å‰‡â†’é¸æ“‡é€£æ¥åŸ â†’è¨­å®šè¦é–‹æ”¾çš„\nportï¼ˆä»¥ä¸Šé¢ä¾‹å­ä¾†èªªå°±æ˜¯ 62754 å’Œ 44372ï¼‰â†’å®Œæˆè¨­å®š\n å…­ã€é‡æ–°å•Ÿå‹•ç¶²ç«™ é—œé–‰ IIS Expressï¼ŒçµæŸåµéŒ¯ï¼ˆä½†ä¸è¦é—œé–‰ VSï¼‰ï¼Œç„¶å¾Œå†é‡æ–°é€²å…¥åµéŒ¯ï¼Œå•Ÿå‹•ç¶²ç«™ã€‚\nä¸ƒã€æ‰‹æ©Ÿç«¯æ¸¬è©¦é€£ç·š æ‰‹æ©Ÿä½¿â½¤å°æ‡‰çš„ URLï¼Œä¾‹å¦‚ http://192.168.40.1:62754ï¼Œå³å¯ç€è¦½ã€‚\n å€‹â¼ˆåå¥½ï¼Œåœ¨æ¸¬è©¦å®Œæˆå¾Œï¼Œæœƒå°‡ applicationhost.config ç¹«çµæ”¹å›ä¾† localhostï¼Œä¸ç„¶é‡é–‹å°ˆæ¡ˆå¾Œï¼Œç¹«çµå¯èƒ½é‡è¨­ï¼Œç¶²ç«™åç¨±å’Œç·¨è™Ÿæœƒâ¼€ç›´å¢åŠ  ï¼ˆä¾‹å¦‚ TestSite â†’ TestSite(1) â†’ TestSite(2) â†’ â€¦ï¼‰\n å‚™è¨»ï¼šç‹€æ³æ’è§£ ä»¥ä¸‹æ˜¯æˆ‘è¨­å®šæ™‚æ›¾ç¶“é‡åˆ°çš„ç‹€æ³å’Œè§£æ±ºæ–¹æ³•ï¼š\nç‹€æ³â¼€ã€The site canâ€™t be reached.ï¼ˆç„¡æ³•é€£ä¸Šé€™å€‹ç¶²ç«™ï¼‰ â†’ æª¢æŸ¥è¼¸å…¥è¦å‰‡æ˜¯å¦è¨­å®šæˆåŠŸã€‚\n ç‹€æ³â¼†ã€Bad Request â€“ Invalid Hostname â†’ æª¢æŸ¥ applicationhost.config çš„ç¹«çµè¨­å®š\n ç›¸é—œé€£çµï¼š  Using Custom Domains With IIS Express  ","description":"æœ‰æ™‚é–‹ç™¼ä¸­éœ€è¦æ¸¬è©¦ä¸åŒç’°å¢ƒæˆ–è£ç½®é–‹å•Ÿç¶²ç«™çš„å·®ç•°ï¼Œè€Œç‚ºäº†æ–¹ä¾¿åµéŒ¯ï¼Œå¯ä»¥è®“ IIS Express å•Ÿå‹•çš„ç¶²ç«™å…è¨±å¤–éƒ¨é€£ç·šé€²ä¾†ã€‚","id":3,"section":"posts","tags":["IIS Express","debug"],"title":"è®“ IIS Express å…è¨±å¤–éƒ¨é€£æ¥ï¼ˆå€ç¶²å…§æ‰‹æ©Ÿæˆ–å…¶ä»–é›»è…¦ç­‰ï¼‰","uri":"https://www.zoeydc.com/zh/posts/2021-06-27-enable_external_access_on_iis_express/"},{"content":"ç•¶æ¡Œâ¾¯æ‡‰â½¤ç¨‹å¼éœ€è¦ç¶²è·¯è³‡æºæ™‚ï¼Œå¯ä»¥â½¤ HttpClient æˆ– WebClient ç­‰ç™¼é€ HTTP è«‹æ±‚ï¼Œä½†æœ‰æ™‚åéä¾†æƒ³è¦é–‹æ”¾æ¡Œâ¾¯ç¨‹å¼çš„è³‡æºä¾›å¤–ç•Œä½¿â½¤å‘¢ï¼Ÿé€™æ™‚å°±å¯ä»¥â½¤ Self Host çš„â½…å¼ï¼Œä¸éœ€è¦ä¾é™„ IIS å°±å¯ä»¥åœ¨ç¨‹å¼è£¡æ›è¼‰ Web APIï¼Œç‚ºç¨‹å¼å’Œå¤–ç•Œè¯ç¹«æä¾›â¼€å€‹ç®¡é“ã€‚\næœ¬ç¯‡æ˜¯è¨˜éŒ„åœ¨ Console ç¨‹å¼ä¸­å¦‚ä½•ä½¿â½¤ Microsoft.AspNet.WebApi.OwinSelfHost å»ºç½® Web APIï¼ŒåŒ…å«ä½¿â½¤ HTTPS ç¶²å€ã€ç¹«çµå¤šå€‹ IP æˆ–åŸŸåã€å•Ÿâ½¤ CORS ç­‰ï¼Œæœ€å¾Œè£œå……äº†ç®¡ç† SSL æ†‘è­‰ç›¸é—œæŒ‡ä»¤èˆ‡ Windows Service ä¸­å•Ÿå‹• Web API çš„ç¨‹å¼ç¢¼ã€‚\nä¸€ã€ç³»çµ±ç’°å¢ƒ  Windows 10 Visual Studio 2019 .NET Framework 4.7.2  â¼†ã€å»ºç«‹ Startup.csï¼ŒWeb API çš„é€²å…¥é» â¾¸å…ˆï¼Œå®‰è£å¥—ä»¶ï¼š\n Install-Package Microsoft.AspNet.WebApi.OwinSelfHost -Version 5.2.7\n ï¼ˆOWIN ç‚º .NET Framework 4.5 ä»¥ä¸Šä½¿â½¤ï¼Œ 4.0 â½¤ Microsoft.AspNet.WebApi.SelfHost è£è¼‰ Web APIï¼‰\næ¥è‘—æ–°å¢é¡åˆ¥ï¼ˆæˆ– OWIN å•Ÿå‹•é¡åˆ¥ï¼‰Startup.csï¼Œè¨­å®šè·¯ç”±è¦å‰‡ï¼Œè®“ Web API ä»¥æ­¤è¦å‰‡åœ¨ OWIN ä¸Šé‹â¾ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  using System.Web.Http; //using System.Web.Http.Cors; using Microsoft.Owin; using Owin; [assembly: OwinStartup(typeof(SelfHostConsole.Startup))] namespace SelfHostConsole { public class Startup { public void Configuration(IAppBuilder app) { // å¦‚éœ€å¦‚ä½•è¨­å®šæ‡‰ç”¨ç¨‹å¼çš„è©³ç´°è³‡è¨Šï¼Œè«‹ç€è¦½ https://go.microsoft.com/fwlink/?LinkID=316888  // Configure Web API for self-host.  HttpConfiguration config = new HttpConfiguration(); config.Routes.MapHttpRoute( name: \u0026#34;DefaultApi\u0026#34;, routeTemplate: \u0026#34;api/{controller}/{id}\u0026#34;, defaults: new { id = RouteParameter.Optional } );  //Enable CORS  //config.EnableCors(new EnableCorsAttribute(\u0026#34;*\u0026#34;, headers: \u0026#34;*\u0026#34;, methods: \u0026#34;*\u0026#34;));  app.UseWebApi(config);  } } }   å¦‚æœç¶²ç«™éœ€è¦è·¨åŸŸè³‡æºå…±äº«ï¼ˆCORSï¼‰ï¼Œå‰‡éœ€å®‰è£ CORS å¥—ä»¶ï¼Œä¸¦å•Ÿç”¨ä¸Šè¿°ç¬¬ 2 å’Œ 22 â¾ï¼š\n Install-Package Microsoft.AspNet.WebApi.Cors -Version 5.2.7\n æ¥ä¸‹ä¾†åœ¨ Program.cs è£¡è¨­å®šåŸ·â¾ç¨‹å¼æ™‚å•Ÿå‹• Web API hostï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  using Microsoft.Owin.Hosting; using System; namespace SelfHostConsole { class Program { static void Main(string[] args) { string baseAddress = \u0026#34;http://localhost:55000/\u0026#34;; Console.WriteLine(\u0026#34;Start OWIN host ...\u0026#34;); using (WebApp.Start\u0026lt;Startup\u0026gt;(url: baseAddress)) { Console.WriteLine(\u0026#34;Wait for a request ...\u0026#34;); Console.ReadLine(); }  } } }   æ­¤æ™‚è‹¥ä»¥ Postman æ¸¬è©¦ Get è¨ªå• http://localhost:55000/ æœƒæ”¶åˆ° 404 Not Foundï¼Œâ½½ä¸æ˜¯å‡ºç¾ Error: connect ECONNREFUSED 127.0.0.1:55000 é€™æ¨£çš„è¨Šæ¯ï¼Œè¡¨â½°é€™æ™‚å€™ Web API çš„åŸºæœ¬æ¶æ§‹å·²ç¶“å®Œæˆäº†ã€‚\nä¸‰ã€åŠ å…¥ Controller ä¾ç…§ç¿’æ…£å–ä»£é…ç½®ï¼ˆConvention over Configurationï¼‰çš„åŸå‰‡ï¼ŒController ä»¥ Controller çµå°¾å°±å¯ä»¥è¢«æ‰¾åˆ°ï¼Œé€™é‚Šç°¡å–®åŠ å€‹ TestControllerã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41  using System.Collections.Generic; using System.Web.Http; namespace SelfHostConsole { public class TestController : ApiController { private static List\u0026lt;MyModel\u0026gt; list = new List\u0026lt;MyModel\u0026gt;() { new MyModel(){Name=\u0026#34;name1\u0026#34;, Value=\u0026#34;value1\u0026#34;}, new MyModel(){Name=\u0026#34;name2\u0026#34;, Value=\u0026#34;value2\u0026#34;}, }; // GET api/test  public IEnumerable\u0026lt;MyModel\u0026gt; Get() { return list; } // GET api/test/1  public MyModel Get(int id) { if (id \u0026lt; 0 || id \u0026gt;= list.Count) return null; return list[id]; } // POST api/test  public IEnumerable\u0026lt;MyModel\u0026gt; Post([FromBody] MyModel newData) { list.Add(newData); return list; } } public class MyModel { public string Name { get; set; } public string Value { get; set; } } }   é€™æ¨£ Web API å°±å¯ä»¥é‹ä½œäº†ã€‚\nâ½¤ Postman æ¸¬è©¦â¼€ä¸‹ï¼Œé‹ä½œæ­£å¸¸ã€‚\n å¦‚æœ Postman æ”¶åˆ°ä»¥ä¸‹çš„è¨Šæ¯ï¼Œç¢ºèªâ¼€ä¸‹æ˜¯å¦æœ‰å°‡ Controller è¨­ç‚º public classã€‚\n1 2 3 4  { \u0026#34;Message\u0026#34;: \u0026#34;No HTTP resource was found that matches the request URI \u0026#39;http://localhost:55000/api/test\u0026#39;.\u0026#34;, \u0026#34;MessageDetail\u0026#34;: \u0026#34;No type was found that matches the controller named \u0026#39;test\u0026#39;.\u0026#34; }   å››ã€å®‰è£ SSL æ†‘è­‰ï¼Œå•Ÿâ½¤ HTTPS è‹¥è¦å•Ÿâ½¤ HTTPSï¼Œç¨‹å¼ç¢¼ç¶²å€éƒ¨åˆ†ç›´æ¥ä¿®æ”¹æˆ https å³å¯ã€‚é™¤æ­¤ä¹‹å¤–ç’°å¢ƒè¦å®‰è£ SSL æ†‘è­‰ã€‚\n1. å»ºç«‹ SSL æ†‘è­‰ é€™é‚Šâ½¤ OpenSSL å»ºç«‹æ†‘è­‰ï¼Œå–å¾— crt å’Œ pfx æª”å¾Œï¼ŒåŒ¯å…¥â¾ƒç°½æ†‘è­‰åˆ°ã€Œå—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½ã€å’Œã€Œä¼ºæœå™¨æ†‘è­‰ã€ã€‚\nä»¥ç³»çµ±ç®¡ç†å“¡â¾åˆ†åŸ·â¾å‘½ä»¤æâ½°å­—å…ƒï¼Œå…¶ä¸­ CertPassword å–ä»£ç‚ºåœ¨å»ºç«‹ pfx æª”æ™‚æ‰€è¼¸å…¥çš„å¯†ç¢¼ã€‚ï¼š\n1  certutil -f -p CertPassword -importpfx \u0026#34;server.pfx\u0026#34;   2. å–å¾—æ†‘è­‰æŒ‡ç´‹ï¼ˆThumbprintï¼‰ åœ¨ã€Œé–‹å§‹ã€åŠŸèƒ½è¡¨æœå°‹ mmc æˆ– certlm.msc ï¼Œé€²åˆ°æ†‘è­‰ç®¡ç†ä»‹â¾¯ï¼Œåœ¨ã€Œå€‹â¼ˆã€æˆ–ã€Œå—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½ã€ä¸­æ‰¾åˆ°åŒ¯å…¥çš„æ†‘è­‰åç¨±ï¼Œå¿«é»å…©ä¸‹é€²åˆ°ã€Œè©³ç´°è³‡æ–™ã€ç•«â¾¯ï¼Œå°‡æ†‘è­‰æŒ‡ç´‹è¨˜éŒ„ä¸‹ä¾†ã€‚ï¼ˆä¹Ÿå¯â½¤ openssl å–å¾—æ†‘è­‰æŒ‡ç´‹)\n 3. å°‡ SSL æ†‘è­‰å’Œ Port ç¶å®š ä»¥ç³»çµ±ç®¡ç†å“¡â¾åˆ†åŸ·â¾å‘½ä»¤æâ½°å­—å…ƒï¼Œå…¶ä¸­ certhash ç‚ºä¸Šâ¼€æ­¥é©Ÿå¾—åˆ°çš„æ†‘è­‰æŒ‡ç´‹ï¼Œappid å‰‡å¡«å…¥ä»»æ„â¼€çµ„ GUIDã€‚ï¼š\n1  netsh http add sslcert ipport=0.0.0.0:55000 certhash=e96255f1941688dcf4be790a2fe61079fc6a87ab appid={bd59f744-97e7-4b9b-b100-9ab561e3bd5a}   4. é€²â¾æ¸¬è©¦ Postman æ¸¬è©¦æ™‚å¯èƒ½æœƒå‡ºç¾ Error: self signed certificateï¼Œæ˜¯å› ç‚ºæ†‘è­‰æª¢æ ¸æ™‚â¾ƒç°½æ†‘è­‰ç„¡æ³•éé—œï¼Œéœ€è¦åœ¨è¨­å®šè£¡å°‡ã€ŒSSL certificate verificationã€é—œé–‰ï¼ˆå»ºè­°æ¸¬è©¦å®Œå¾Œæ¢å¾©é€²â¾æª¢æ ¸ï¼‰ã€‚æ­£å¸¸ä¾†èªªå¯ä»¥å¾—åˆ°å’Œå…ˆå‰â¼€æ¨£çš„çµæœï¼Œé™¤äº†ç¶²å€ http ç¾åœ¨æ›æˆ httpsã€‚\näº”ã€ç¹«çµå¤šå€‹ IP æˆ–åŸŸå åœ¨ Program.cs å•Ÿå‹• Web API æ˜¯ä½¿ç”¨ WebApp.Start(url: baseAddress) ä¾†è¨­å®šç¶²å€ï¼Œè§€å¯Ÿå®ƒçš„ Metadataï¼ŒStart æ–¹æ³•é™¤äº†å‚³å…¥ url ç¶²å€å¤–ï¼Œé‚„æœ‰å¦ä¸€å€‹å‚³å…¥ StartOptions çš„å¤šè¼‰ï¼Œè£¡é¢æœ‰å€‹ Urls çš„ Propertyï¼Œèªªæ˜ç‚ºã€ŒA list of url prefixes to listen on. Overrides port.ã€ï¼Œæ‰€ä»¥å°±æ˜¯å¾é€™é‚Šä¸‹æ‰‹äº†ã€‚\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  class Program { static void Main(string[] args) { StartOptions options = new StartOptions(); options.Urls.Add(\u0026#34;https://localhost:55000/\u0026#34;); options.Urls.Add(\u0026#34;http://localhost:55001/\u0026#34;);  Console.WriteLine(\u0026#34;Start OWIN host ...\u0026#34;); using (WebApp.Start\u0026lt;Startup\u0026gt;(options: options)) \t{ Console.WriteLine(\u0026#34;Wait for a request ...\u0026#34;); Console.ReadLine(); } } }   é€™æ¨£å°±å®Œæˆäº†å¤šå€‹ IP çš„ç¹«çµã€‚\nè£œå…… 1. SSL æ†‘è­‰å®‰è£åˆªé™¤æŸ¥è©¢ åƒè€ƒã€Œâ½¤ certutil æ–°å¢åˆªé™¤æŸ¥è©¢ SSL æ†‘è­‰ã€ã€‚\n2. SSL ç¹«çµ Port åŠåˆªé™¤ã€æŸ¥è©¢ç¹«çµ 1 2 3 4  netsh http add sslcert ipport=0.0.0.0:55000 certhash=e96255f1941688dcf4be790a2fe61079fc6a87ab appid={bd59f744-97e7-4b9b-b100-9ab561e3bd5a} netsh http delete sslcert ipport=0.0.0.0:55000 netsh http show sslcert netsh http show sslcert ipport=0.0.0.0:55000   3. åœ¨ Windows Service ä¸­å•Ÿå‹• Web API è¦†å¯« OnStart èˆ‡ OnStop æ–¹æ³•æ™‚åˆ†åˆ¥å»ºç«‹å’Œé‡‹æ”¾ Web API è³‡æºã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  using Microsoft.Owin.Hosting; using System; using System.ServiceProcess; namespace SelfHost { public partial class SelfHostService : ServiceBase { private IDisposable _server = null;  public SelfHostService() { InitializeComponent(); } protected override void OnStart(string[] args) { _server = WebApp.Start\u0026lt;Startup\u0026gt;(\u0026#34;https://localhost:55000/\u0026#34;);  } protected override void OnStop() { if (_server != null) { _server.Dispose(); }  base.OnStop(); } } }   ç›¸é—œé€£çµï¼š  [Microsoft Docs] â¾ƒæˆ‘è£è¼‰ ASP.NET Web API 1 ï¼ˆC#ï¼‰ [Microsoft Docs] ä½¿â½¤ OWIN â¾ƒæˆ‘è£è¼‰ ASP.NET Web API [Microsoft Docs] å¦‚ä½•ï¼šä½¿â½¤ MMC åµŒå…¥å¼ç®¡ç†å–®å…ƒä¾†æŸ¥çœ‹æ†‘è­‰ [Microsoft Docs] ä½œæ³•ï¼šä½¿â½¤ SSL æ†‘è­‰è¨­å®šé€£æ¥åŸ  [WILLä¿å“¥] å¦‚ä½•ä½¿â½¤ OpenSSL å»ºç«‹é–‹ç™¼æ¸¬è©¦â½¤é€”çš„â¾ƒç°½æ†‘è­‰ (Self-Signed Certificate) [â¿Šæš—åŸ·â¾ç·’] PostMan ç„¡æ³•é€£ç·š IIS Express ç¶²ç«™ OWIN WebAPI Service example ","description":"æœ¬ç¯‡æ˜¯è¨˜éŒ„åœ¨ Console ç¨‹å¼ä¸­å¦‚ä½•ä½¿â½¤ Microsoft.AspNet.WebApi.OwinSelfHost å»ºç½® Web APIï¼ŒåŒ…å«ä½¿â½¤ HTTPS ç¶²å€ã€ç¹«çµå¤šå€‹ IP æˆ–åŸŸåã€å•Ÿâ½¤ CORS ç­‰ï¼Œæœ€å¾Œè£œå……äº†ç®¡ç† SSL æ†‘è­‰ç›¸é—œæŒ‡ä»¤èˆ‡ Windows Service ä¸­å•Ÿå‹• Web API çš„ç¨‹å¼ç¢¼ã€‚","id":4,"section":"posts","tags":["OWIN","Self Host","ASP.NET","Web API","SSL","IIS"],"title":"å… IISï¼Œâ½¤ OWIN æ¶è¨­è¼•é‡ç´š ASP.NET Web API","uri":"https://www.zoeydc.com/zh/posts/2021-06-13-owin-selfhost-webapi-console/"},{"content":"è¨˜éŒ„â½¤ certutil æ–°å¢ã€åˆªé™¤ã€æŸ¥è©¢åœ¨ã€Œæœ¬æ©Ÿé›»è…¦ã€çš„ã€Œå€‹â¼ˆã€æˆ–ã€Œå—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½ã€å­˜æ”¾å€çš„ SSL æ†‘è­‰çš„æŒ‡ä»¤ã€‚\nå‰ç½®ä½œæ¥­ï¼šæŸ¥è©¢æ†‘è­‰æŒ‡ç´‹ï¼ˆFingerprintã€Thumbprintï¼‰ æœ¬ç¯‡æ†‘è­‰æ˜¯â½¤ OpenSSL æ‰€ç”¢â½£çš„ crt å’Œ pfx æª”ï¼Œå¦å¤–åˆªé™¤æˆ–æŸ¥è©¢æ†‘è­‰è³‡è¨Šæ™‚éœ€â½¤åˆ°æ†‘è­‰æŒ‡ç´‹ï¼Œå¯ (1) ç›´æ¥â½¤ OpenSSL å–å¾—ï¼Œæˆ– (2) åŒ¯å…¥æ†‘è­‰å¾Œé€²åˆ° MMC ä»‹â¾¯æŸ¥è©¢ ã€‚\n(1) OpenSSL å°‡å–å¾—é¡ä¼¼ã€ŒSHA1 Fingerprint=E9:62:55:F1:94:16:88:DC:F4:BE:79:0A:2F:E6:10:79:FC:6A:87:ABã€çš„â¼€ä¸²æ–‡å­—ï¼Œä½¿â½¤æ™‚å–ã€ŒFingerprint=ã€ä¹‹å¾Œçš„æ–‡å­—ä¸¦å°‡å†’è™Ÿå»é™¤ã€‚\nä»¥å‘½ä»¤æç¤ºå­—å…ƒåŸ·è¡ŒæŸ¥è©¢ï¼š\n1 2 3 4 5 6 7 8 9  REM CertificateFile ç‚ºæ†‘è­‰æª”åç¨± REM æŸ¥è©¢æ†‘è­‰æŒ‡ç´‹ \u0026gt; openssl x509 -in CertificateFile.crt -fingerprint -noout SHA1 Fingerprint=E9:62:55:F1:94:16:88:DC:F4:BE:79:0A:2F:E6:10:79:FC:6A:87:AB REM æŸ¥è©¢åºè™Ÿ \u0026gt; openssl x509 -in CertificateFile.crt -serial -noout serial=6D53BD345F83AF5C3CFC1CE36C2540273C74B607   (2) MMC ä»‹é¢  å—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½ï¼ˆrootï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  REM åŒ¯å…¥ certutil -addstore -f \u0026#34;ROOT\u0026#34; CertificateFile.crt REM ä¸Šè¿°åŒ¯å…¥æ†‘è­‰å¾Œï¼Œå¦‚è¦å†åŒ¯å…¥å¯†é‘°ï¼ˆâ¼€èˆ¬ä¸éœ€è¦ï¼‰ REM CertPassword ç‚ºç”¢â½£ pfx æ™‚è¼¸å…¥çš„å¯†ç¢¼ certutil -f -p CertPassword -importpfx root \u0026#34;CertificateFile.pfx\u0026#34; REM ä¾æ†‘è­‰æŒ‡ç´‹é€²è¡Œåˆªé™¤ certutil -delstore root \u0026#34;e96255f1941688dcf4be790a2fe61079fc6a87ab\u0026#34; REM æŸ¥è©¢æ‰€æœ‰å—ä¿¡ä»»çš„æ ¹æ†‘è­‰ certutil -store root REM é‡å°æ†‘è­‰æŒ‡ç´‹é€²â¾æŸ¥è©¢ certutil -store root \u0026#34;e96255f1941688dcf4be790a2fe61079fc6a87ab\u0026#34;   å€‹â¼ˆå­˜æ”¾å€ï¼ˆmyï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  REM åŒ¯å…¥æ†‘è­‰ï¼ˆç„¡å¯†é‘°ï¼‰ certutil -addstore -f my CertificateFile.crt REM åŒ¯å…¥æ†‘è­‰åŠå¯†é‘°åˆ°å€‹äººå­˜æ”¾å€ï¼Œã€ŒåŒæ™‚ã€ä¹Ÿæœƒæ–°å¢åˆ°å—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½ root REM CertPassword ç‚ºç”¢ç”Ÿ pfx æ™‚è¼¸å…¥çš„å¯†ç¢¼ certutil -f -p CertPassword -importpfx my \u0026#34;CertificateFile.pfx\u0026#34; (certutil -f -p CertPassword -importpfx \u0026#34;CertificateFile.pfx\u0026#34;) REM ä¾æ†‘è­‰æŒ‡ç´‹é€²è¡Œåˆªé™¤ REM åªåˆªé™¤åœ¨å€‹äººå­˜æ”¾å€ \u0026#34;my\u0026#34; çš„æ†‘è­‰ï¼Œåˆªé™¤åœ¨ \u0026#34;root\u0026#34; çš„æ†‘è­‰éœ€è¦å¦å¤–åŸ·è¡Œ certutil -delstore my \u0026#34;e96255f1941688dcf4be790a2fe61079fc6a87ab\u0026#34; REM æŸ¥è©¢æ‰€æœ‰å€‹äººæ†‘è­‰ certutil -store my REM é‡å°æ†‘è­‰æŒ‡ç´‹é€²è¡ŒæŸ¥è©¢ certutil -store my \u0026#34;e96255f1941688dcf4be790a2fe61079fc6a87ab\u0026#34;   å‚™è¨»1ï¼šè‹¥åŒ¯å…¥ pfx æª”åˆ°å€‹äººå­˜æ”¾å€ï¼Œå‰‡åœ¨ IIS çš„ä¼ºæœå™¨æ†‘è­‰ä¸­ä¹Ÿå¯ä»¥æŸ¥è©¢åˆ°ã€‚\nå‚™è¨»2ï¼šè‹¥æ˜¯å¾ IIS ä¼ºæœå™¨æ†‘è­‰åŒ¯å…¥æ†‘è­‰åˆ°å€‹äººå­˜æ”¾å€ï¼Œé‚£å°±åªæœƒåœ¨å€‹äººå­˜æ”¾å€æœ‰ï¼Œä¸æœƒåŒæ™‚æ–°å¢åˆ° rootã€‚\nå‚™è¨»3ï¼šè‹¥æ˜¯ç®¡ç†ã€Œç›®å‰çš„ä½¿ç”¨è€…ã€ï¼ˆCurrent Userï¼‰çš„æ†‘è­‰ï¼Œåœ¨ certutil å¾ŒåŠ ä¸Š -user å³å¯ï¼Œä¾‹å¦‚ï¼šcertutil -user -addstore -f my CertificateFile.crtã€‚ã€Œç›®å‰çš„ä½¿ç”¨è€…ã€çš„æ†‘è­‰æœƒç¹¼æ‰¿ã€Œæœ¬æ©Ÿé›»è…¦ã€æ‰€æœ‰çš„æ†‘è­‰ï¼Œé™¤äº†åœ¨ã€Œæœ¬æ©Ÿé›»è…¦ã€çš„ã€Œå€‹äººå­˜æ”¾å€ã€çš„æ†‘è­‰ï¼ˆåƒè€ƒé€£çµ3ï¼‰ã€‚\nç›¸é—œé€£çµï¼š  [Microsoft Docs] å¦‚ä½•ï¼šä½¿ç”¨ MMC åµŒå…¥å¼ç®¡ç†å–®å…ƒä¾†æŸ¥çœ‹æ†‘è­‰ [Microsoft Docs] certutil [Microsoft Docs] Local Machine and Current User Certificate Stores ","description":"è¨˜éŒ„â½¤ certutil æ–°å¢ã€åˆªé™¤ã€æŸ¥è©¢åœ¨ã€Œæœ¬æ©Ÿé›»è…¦ã€çš„ã€Œå€‹â¼ˆã€æˆ–ã€Œå—ä¿¡ä»»çš„æ ¹æ†‘è­‰æˆæ¬Šå–®ä½ã€å­˜æ”¾å€çš„ SSL æ†‘è­‰çš„æŒ‡ä»¤ã€‚","id":5,"section":"posts","tags":["certutil","SSL"],"title":"â½¤ certutil æ–°å¢åˆªé™¤æŸ¥è©¢ SSL æ†‘è­‰","uri":"https://www.zoeydc.com/zh/posts/2021-06-04-certutil-store-ssl/"},{"content":"è»Ÿé«”å¾é–‹ç™¼åˆ°â½£ç”¢çš„å„å€‹éšæ®µï¼Œå¾ˆå¸¸é‡åˆ°ä¸åŒç’°å¢ƒéœ€è¦ä¸åŒçš„çµ„æ…‹è¨­å®šï¼ˆä¾‹å¦‚è³‡æ–™åº«é€£ç·šå­—ä¸²ã€ç³»çµ±è³‡æºå°æ‡‰è·¯å¾‘ç­‰ï¼‰ï¼Œé€™äº›ç¹ç‘£çš„è¨­å®šè‹¥æ˜¯æ¯æ¬¡éƒ½â¼¿å‹•ä¿®æ”¹å¯¦åœ¨å®¹æ˜“å‡ºéŒ¯ï¼Œâ½½ Visual Studio æœ¬â¾å°±æœ‰ Web.config çµ„æ…‹æª”è½‰æ›åŠŸèƒ½ï¼Œå¥½å¥½åˆ©â½¤å¯ä»¥â¼¤â¼¤ç¯€ç´„æ™‚é–“ä¸¦é™ä½éŒ¯èª¤æ©Ÿç‡ï¼Œæ›´èƒ½å°ˆæ³¨åœ¨é–‹ç™¼æœ¬â¾ã€‚\nå°ˆæ¡ˆå»ºç«‹å¥½æ™‚é è¨­æœ‰å…©å€‹çµ„æ…‹ Debug å’Œ Releaseï¼Œâ¼€èˆ¬æˆ‘æœƒå†å»ºç«‹â¼€å€‹ Test çµ„æ…‹åœ¨æ¸¬è©¦ç’°å¢ƒä½¿â½¤ï¼Œæ‰€ä»¥æœ¬ç¯‡è¨˜éŒ„ 1. å¦‚ä½•æ–°å¢çµ„æ…‹å’Œèˆ‡ä¹‹å°æ‡‰çš„ Web.config è¨­å®šæª”ï¼Œå’Œ 2. è¨­å®š Web.config è½‰æ›å…§å®¹ã€‚\nâ¼€ã€å‰ç½®ä½œæ¥­  ä»¥ ASP.NET MVC çš„é è¨­ç¯„æœ¬å»ºç«‹å°ˆæ¡ˆï¼ˆVisual Studio 2019ï¼‰ æª¢è¦–é è¨­çµ„æ…‹è¨­å®šï¼šé è¨­çš„ Debug å’Œ Release çµ„æ…‹å„æœ‰â¼€å€‹å°æ‡‰çš„ config æª”ï¼ˆWeb.{çµ„æ…‹åç¨±}.configï¼‰   â¼†ã€æ–°å¢çµ„æ…‹è¨­å®šèˆ‡è¨­å®šæª” å¾ã€Œçµ„æ…‹ç®¡ç†å“¡ã€ä¸­æ–°å¢ã€ŒTestã€çµ„æ…‹å¾Œï¼Œåœ¨â½…æ¡ˆç¸½ç®¡ä¸­æœƒç™¼ç¾ Web.Test.config æª”æ¡ˆä¸¦æ²’æœ‰â¾ƒå‹•ç”¢â½£ï¼Œéœ€è¦â¼¿å‹•ã€Œæ–°å¢è¨­å®šè½‰æ›ã€ï¼ˆAdd Transformï¼‰ï¼Œæª”æ¡ˆå°±æœƒå‡ºç¾äº†ã€‚\n  ä¸‰ã€è¨­å®šä¸åŒçµ„æ…‹ç™¼â¾æ™‚å°æ‡‰çš„ Web.config æ¥ä¸‹ä¾†è¦ç·¨è¼¯é€™äº›æª”æ¡ˆè£¡â¾¯çš„å…§å®¹äº†ï¼äº†è§£èªæ³•ä¹‹å‰ä¾†å¿«é€Ÿçœ‹â¼€ä¸‹â¼€å€‹ç°¡å–®çš„è½‰æ›ç¯„ä¾‹å’Œå‘ˆç¾çš„æ•ˆæœã€‚\nç¯„ä¾‹èˆ‡æ•ˆæœ å°±ä»¥ç™¼ä½ˆ Release çµ„æ…‹ä¾†èªªï¼Œå‡è¨­åŸæœ¬çš„ Web.config æœ‰å€‹åƒæ•¸ Envï¼š\n\u0026lt;appSettings\u0026gt; \u0026lt;add key=\u0026#34;Env\u0026#34; value=\u0026#34;Dev\u0026#34;/\u0026gt; \u0026lt;/appSettings\u0026gt; å°ç…§åœ¨ Web.Release.config çš„ Env åƒæ•¸è¨­å®šï¼Œé™¤äº†å°‡ value è¨­ç‚º Release å¤–ï¼Œå¦å¤–åŠ äº† xdt:Transform å’Œ xdt:Locator å±¬æ€§ï¼ˆå±¬æ€§è©³ç´°èªªæ˜â¾’ä¸‹æ–¹èªæ³•è©³è¿°ï¼‰ï¼Œå¦‚ä¸‹ï¼š\n\u0026lt;appSettings\u0026gt; \u0026lt;add key=\u0026#34;Env\u0026#34; value=\u0026#34;Release\u0026#34; xdt:Transform=\u0026#34;SetAttributes\u0026#34; xdt:Locator=\u0026#34;Match(key)\u0026#34;/\u0026gt; \u0026lt;/appSettings\u0026gt; å¯¦éš›ç™¼ä½ˆæ™‚ï¼Œ Env çš„è¨­å®šå°±æœƒè½‰æ›ç‚º Releaseäº†ã€‚\næˆ–è€…å¯ä»¥â½¤å…§å»ºçš„é è¦½â¼¯å…·ç™¼ä½ˆå‰é å…ˆæª¢è¦–çµæœèˆ‡å·®ç•°è™•ï¼š\n  â†‘ å·¦é‚Šæ˜¯åŸå§‹çš„è¨­å®šæª”ï¼Œå³é‚Šå‰‡æ˜¯è½‰æ›å¾Œçš„çµæœï¼Œå·®ç•°è™•ä¹Ÿéƒ½â¾ƒå‹•æ¨™è¨˜äº†ã€‚\nèªæ³•è©³è¿°ï¼ˆWeb.config Transformation Syntaxï¼‰ å›é¡§â¼€ä¸‹ Web.Release.config çš„åŸå§‹å…§å®¹ï¼Œæˆ–è€…æ–°å»ºçš„ Web.Test.config ä¹Ÿæœ‰ç›¸åŒçš„å…§å®¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;!-- å¦‚éœ€ä½¿ç”¨ web.config è½‰æ›çš„è©³ç´°è³‡è¨Šï¼Œè«‹å‰å¾€ https://go.microsoft.com/fwlink/?LinkId=125889 --\u0026gt; \u0026lt;configuration xmlns:xdt=\u0026#34;http://schemas.microsoft.com/XML-Document-Transform\u0026#34;\u0026gt;  \u0026lt;!-- åœ¨ä¸‹é¢çš„ç¯„ä¾‹ä¸­ï¼Œ\u0026#34;SetAttributes\u0026#34; è½‰æ›åªæœƒåœ¨ \u0026#34;Match\u0026#34; å®šä½ç¨‹å¼æ‰¾åˆ° å€¼ç‚º \u0026#34;MyDB\u0026#34; çš„å±¬æ€§ \u0026#34;name\u0026#34; æ™‚ï¼Œæ‰å°‡ \u0026#34;connectionString\u0026#34; çš„å€¼è®Š æ›´ç‚ºä½¿ç”¨ \u0026#34;ReleaseSQLServer\u0026#34;ã€‚ \u0026lt;connectionStrings\u0026gt; \u0026lt;add name=\u0026#34;MyDB\u0026#34; connectionString=\u0026#34;Data Source=ReleaseSQLServer;Initial Catalog=MyReleaseDB;Integrated Security=True\u0026#34; xdt:Transform=\u0026#34;SetAttributes\u0026#34; xdt:Locator=\u0026#34;Match(name)\u0026#34;/\u0026gt; \u0026lt;/connectionStrings\u0026gt; --\u0026gt; \u0026lt;system.web\u0026gt; \u0026lt;compilation xdt:Transform=\u0026#34;RemoveAttributes(debug)\u0026#34; /\u0026gt;  \u0026lt;!-- åœ¨ä¸‹é¢çš„ç¯„ä¾‹ä¸­ï¼Œ\u0026#34;Replace\u0026#34; è½‰æ›å°‡æœƒå–ä»£ web.config æª”æ¡ˆ çš„æ•´å€‹ \u0026lt;customErrors\u0026gt; å€æ®µã€‚ è«‹æ³¨æ„ï¼Œå› ç‚ºåœ¨ \u0026lt;system.web\u0026gt; ç¯€é»ä¹‹ä¸‹ åªæœ‰ä¸€å€‹ customErrors å€æ®µï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨ \u0026#34;xdt:Locator\u0026#34; å±¬æ€§ã€‚ \u0026lt;customErrors defaultRedirect=\u0026#34;GenericError.htm\u0026#34; mode=\u0026#34;RemoteOnly\u0026#34; xdt:Transform=\u0026#34;Replace\u0026#34;\u0026gt; \u0026lt;error statusCode=\u0026#34;500\u0026#34; redirect=\u0026#34;InternalError.htm\u0026#34;/\u0026gt; \u0026lt;/customErrors\u0026gt; --\u0026gt; \u0026lt;/system.web\u0026gt; \u0026lt;/configuration\u0026gt;   å’Œâ¼€èˆ¬ Web.config ä¸åŒçš„æ˜¯ï¼Œå®ƒå¼•â½¤äº† XML-Document-Transform å‘½åç©ºé–“ï¼ˆç¬¬ 3 â¾ï¼‰ï¼Œå°æ‡‰åˆ° xdt å‰ç½®è©çš„ä½¿â½¤ï¼ˆxdt:Locator å’Œ xdt:Transformï¼‰ï¼Œâ½¤ä¾†è™•ç†å…ƒç´ å’Œå±¬æ€§çš„è½‰æ›ï¼›xdt å‰ç½®è©åœ¨è½‰æ›å¾Œçš„æ–‡ä»¶ä¸­ä¸æœƒå‡ºç¾ã€‚\nã€Locatorã€‘ â½¤ä¾†å®šä½è¦è½‰æ›çš„å…ƒç´ ä½ç½®ï¼Œç‚ºéå¿…è¦å±¬æ€§ï¼Œè‹¥æœªè¨­å®šæ™‚å‰‡æ‰¾å‡ºæ‰€æœ‰åŒå±¤ç´šå…ƒç´ ï¼Œå†ä¾ Transform å±¬æ€§æ±ºå®šè½‰æ›æ¨¡å¼ã€‚Locator æœ‰ä¸‰ç¨®è¨­å®šâ½…å¼ã€‚\nxdt:Locator=\u0026#34;Condition(XPath é‹ç®—å¼)\u0026#34; ç¯„ä¾‹ï¼šxdt:Locator=\u0026#34;Condition(@name=\u0026#39;oldname\u0026#39; or @providerName=\u0026#39;oldprovider\u0026#39;)\u0026#34; èªªæ˜ï¼šæ‰¾åˆ°ç¬¦åˆ XPath é‹ç®—å¼æ¢ä»¶çš„å…ƒç´ ã€‚ä¾‹å¦‚å±¬æ€§ name ç‚º oldname æˆ– providerName ç‚º oldprovider çš„æ‰€æœ‰å…ƒç´ ã€‚\nxdt:Locator=\u0026#34;Match(å±¬æ€§1,å±¬æ€§2,å±¬æ€§3,â€¦)\u0026#34; ç¯„ä¾‹ï¼š\u0026lt;add name=\u0026#34;AWLT\u0026#34; connectionString=\u0026#34;newstring\u0026#34; providerName=\u0026#34;newprovider\u0026#34; xdt:Transform=\u0026#34;Replace\u0026#34; xdt:Locator=\u0026#34;Match(name, providerName)\u0026#34; èªªæ˜ï¼šæ‰¾åˆ°èˆ‡æ‰€åˆ—å±¬æ€§çš„å€¼ã€Œçš†ã€ç›¸åŒçš„å…ƒç´ ã€‚ä¾‹å¦‚å±¬æ€§ name ç‚º AWLT ä¸” providerName ç‚º newprovider çš„æ‰€æœ‰å…ƒç´ ã€‚\nxdt:Locator=\u0026#34;XPath(XPath é‹ç®—å¼)\u0026#34; ç¯„ä¾‹ï¼š\u0026lt;add name=\u0026#34;AWLT2\u0026#34; connectionString=\u0026#34;newstring\u0026#34; providerName=\u0026#34;newprovider\u0026#34; xdt:Transform=\u0026#34;Replace\u0026#34; xdt:Locator=\u0026#34;XPath(/configuration/connectionStrings/add[@name=\u0026#39;AWLT\u0026#39; or @providerName=\u0026#39;oldprovider\u0026#39;])\u0026#34;/\u0026gt; èªªæ˜ï¼šå®Œå…¨ä½¿â½¤ XPath é‹ç®—å¼ï¼ˆçµ•å°è·¯å¾‘ï¼‰ä¾†å°‹æ‰¾å…ƒç´ ï¼Œä¸ä»¥å…ƒç´ ç¾åœ¨çš„ä½ç½®ç‚ºåƒè€ƒã€‚ä¾‹å¦‚å³ä½¿å°‡ä¸Šè¿°æ¨™ç±¤æ”¾åˆ° \u0026lt;appSettings\u0026gt; å…ƒç´ ä¸‹æˆ–ç›´æ¥æ”¾åœ¨ \u0026lt;configuration\u0026gt; åº•ä¸‹ï¼Œå…¶ä¾ç„¶æœƒæ‰¾åˆ° connectionStrings ä¸­ï¼Œç¬¦åˆ name ç‚º AWLT æˆ– providerName ç‚º oldprovider çš„æ‰€æœ‰å…ƒç´ ã€‚\nã€Transformã€‘ èªªæ˜å…ƒç´ å±¬æ€§è©²å¦‚ä½•è½‰æ›ï¼Œæœ‰å…«ç¨®â½…å¼ã€‚\nxdt:Transform=\u0026#34;Replace\u0026#34; èªªæ˜ï¼šä»¥è½‰æ›æª”ï¼ˆWeb.{çµ„æ…‹åç¨±}.configï¼‰ä¸­çš„å…ƒç´ å–ä»£ Locator å±¬æ€§åœ¨ Web.config ä¸­æœƒæ‰¾åˆ°çš„å…ƒç´ ã€‚å¦‚æœæ‰¾åˆ°å¤šå€‹å…ƒç´ ï¼Œåªæœƒå–ä»£ç¬¬â¼€å€‹ã€‚\nxdt:Transform=\u0026#34;Insert\u0026#34; èªªæ˜ï¼šå°‡è½‰æ›æª”çš„å…ƒç´ åŠ å…¥ Web.config ä¸­ Locator æ‰€å®šç¾©çš„åŒå±¤ç´šçš„å…ƒç´ å€åŸŸä¸­çš„æœ€å¾Œâ¾¯ã€‚\nxdt:Transform=\u0026#34;InsertBefore(XPath é‹ç®—å¼)\u0026#34; èªªæ˜ï¼šå°‡è½‰æ›æª”çš„å…ƒç´ æ’å…¥ XPath é‹ç®—å¼ï¼ˆçµ•å°è·¯å¾‘ï¼‰æ‰€æŒ‡çš„å…ƒç´ å‰â¾¯ï¼ˆä¸æ˜¯ Locator æ‰€æŒ‡çš„å…ƒç´ ï¼Œåœ¨æ­¤è™• Locator æ²’æœ‰ä½œâ½¤ï¼‰ã€‚\n1 2 3  \u0026lt;authorization\u0026gt; \u0026lt;allow roles=\u0026#34;Admins\u0026#34; xdt:Transform= \u0026#34;InsertBefore(/configuration/system.web/authorization/deny[@users=\u0026#39;*\u0026#39;])\u0026#34; /\u0026gt; \u0026lt;/authorization\u0026gt;   ä¸Šâ¾¯ç¯„ä¾‹è¨­å®šè½‰æ›æ™‚åœ¨ã€Œæ‹’çµ•æ‰€æœ‰ä½¿â½¤è€…ã€çš„é …â½¬å‰ï¼Œæ’å…¥ã€Œå…è¨±ç³»çµ±ç®¡ç†è€…ã€çš„æˆæ¬Šã€‚\nxdt:Transform=\u0026#34;InsertAfter(XPath é‹ç®—å¼)\u0026#34; èªªæ˜ï¼šå’Œ InsertBefort ç›¸åï¼Œæ˜¯å°‡è½‰æ›æª”çš„å…ƒç´ æ’å…¥ XPath é‹ç®—å¼ï¼ˆçµ•å°è·¯å¾‘ï¼‰æ‰€æŒ‡çš„å…ƒç´ å¾Œâ¾¯ã€‚\nxdt:Transform=\u0026#34;Remove\u0026#34; èªªæ˜ï¼šç§»é™¤ Locator æ‰¾åˆ°çš„ç¬¬â¼€å€‹å…ƒç´ ã€‚\nxdt:Transform=\u0026#34;RemoveAll\u0026#34; èªªæ˜ï¼šç§»é™¤ Locator æ‰¾åˆ°çš„æ‰€æœ‰å…ƒç´ ã€‚\nxdt:Transform=\u0026#34;RemoveAttributes(å±¬æ€§1,å±¬æ€§2,å±¬æ€§3,â€¦)\u0026#34; èªªæ˜ï¼šLocator æ‰¾åˆ°å…ƒç´ å¾Œï¼Œç§»é™¤æ‰€æŒ‡å®šçš„â¼€åˆ°å¤šå€‹å±¬æ€§ã€‚å¦‚æœæœªé¸æ“‡ä»»ä½•å±¬æ€§ï¼Œå‰‡æ‰€æœ‰å±¬æ€§çš†ç§»é™¤ã€‚\n1  \u0026lt;compilation xdt:Transform=\u0026#34;RemoveAttributes(debug)\u0026#34; /\u0026gt;   Web.Release.config é è¨­å°±æœƒç§»é™¤ compilation çš„ debug å±¬æ€§ï¼Œä»¥æâ¾¼ç™¼â¾æ™‚ç¨‹å¼é‹â¾çš„æ•ˆèƒ½ã€‚ï¼ˆåŸå§‹å…§å®¹ç¬¬ 16 â¾ï¼‰\nTransform=\u0026#34;SetAttributes(å±¬æ€§1,å±¬æ€§2,å±¬æ€§3,â€¦)\u0026#34; èªªæ˜ï¼šLocator æ‰¾åˆ°å…ƒç´ å¾Œï¼Œä¾ç…§è½‰æ›æª”çš„å±¬æ€§è¨­å®šæ‰€æŒ‡å®šçš„â¼€åˆ°å¤šå€‹å±¬æ€§ã€‚å¦‚æœæœªé¸æ“‡ä»»ä½•å±¬æ€§ï¼Œå‰‡æ‰€æœ‰å±¬æ€§çš†ä¾è½‰æ›æª”é€²â¾è¨­å®šã€‚\nåƒè€ƒç¶²å€ï¼š  [Microsoft Docs] ä½¿ç”¨ Visual Studio çš„ ASP.NET Web éƒ¨ç½²ï¼š Web.config æª”è½‰æ› [Microsoft Docs] Web.config Transformation Syntax for Web Application Project Deployment ","description":"è»Ÿé«”å¾é–‹ç™¼åˆ°â½£ç”¢çš„å„å€‹éšæ®µï¼Œå¾ˆå¸¸é‡åˆ°ä¸åŒç’°å¢ƒéœ€è¦ä¸åŒçš„çµ„æ…‹è¨­å®šï¼Œè‹¥èƒ½å–„ç”¨ Visual Studio æœ¬â¾çµ„æ…‹æª”çš„è½‰æ›åŠŸèƒ½ï¼Œå¯ä»¥â¼¤â¼¤ç¯€ç´„æ™‚é–“ä¸¦é™ä½éŒ¯èª¤æ©Ÿç‡ï¼Œæ›´èƒ½å°ˆæ³¨åœ¨é–‹ç™¼ä¸Šã€‚æœ¬ç¯‡è¨˜éŒ„ (1) å¦‚ä½•æ–°å¢çµ„æ…‹å’Œ Web.config è¨­å®šæª”ï¼Œå’Œ (2) è¨­å®š Web.config è½‰æ›å…§å®¹ã€‚","id":6,"section":"posts","tags":["visual studio","config transforms"],"title":"Visual Studio ç™¼ä½ˆå°ˆæ¡ˆæ™‚â¾ƒå‹•è½‰æ›çµ„æ…‹å°æ‡‰çš„ Web.config","uri":"https://www.zoeydc.com/zh/posts/2021-05-29-visual-studio-webconfig/"},{"content":"ä¸€ç›´æœ‰å»ºéƒ¨è½æ ¼çš„æƒ³æ³•ï¼Œä¹Ÿè©¦éä¸€äº›éƒ¨è½æ ¼å¹³å°å’Œ WordPressï¼Œè¦ºå¾—å¹³å°ä¸Šé–‹ç«™é›–ç„¶æ–¹ä¾¿ï¼Œåªè¦è¨»å†Šå¸³è™Ÿå°±å¥½ï¼Œä½†æ˜¯ç‰ˆå‹èª¿æ•´æ–¹å¼æœ‰é™ï¼Œç„¡æ³•å°‡ç¶²ç«™æ”¹æˆç¬¦åˆè‡ªå·±å¿ƒæ„çš„æ¨¡æ¨£ï¼Œç›¸è¼ƒè€Œè¨€ï¼ŒWordPress è‡ªç”±åº¦å¾ˆé«˜ï¼Œä¸éæ¶æ§‹ä¹Ÿç›¸å°è¤‡é›œï¼Œé‚„éœ€è¦ç®¡ç†å¤–æ›å’Œè³‡æ–™åº«ï¼Œæœ‰é»éº»ç…©ï¼Œä¸å¤ªç¬¦åˆå–®ç´”å¯«æ–‡ç« çš„æƒ³æ³•ï¼Œç¶“éä¸€ç•ªæœå°‹å¾Œï¼Œæ±ºå®šç”¨éœæ…‹ç¶²ç«™ä¾†æ¶è¨­æˆ‘çš„éƒ¨è½æ ¼ï¼\né›–ç„¶ GitHub Pages æ¨è–¦ä½¿ç”¨ Jekyll ç”Ÿæˆéœæ…‹ç¶²é ï¼Œä½†åœ¨ Windows ç’°å¢ƒä¸‹ Jekyll ä¼¼ä¹æ¯”è¼ƒä¸å‹å–„ï¼Œè€Œ Hugo å…¥é–€ç›¸å°å®¹æ˜“ã€å®˜æ–¹æ–‡ä»¶æœ‰å®Œæ•´çš„æ•™å­¸ï¼Œé‚„æœ‰ç·¨è­¯é€Ÿåº¦å¿«ç­‰å„ªé»ï¼Œçœ¾å¤šå› ç´ è€ƒæ…®ä¸‹ï¼Œæˆ‘é¸æ“‡äº† Hugoã€‚\nä¸éé‚„æ˜¯èŠ±äº†ä¸€äº›æ™‚é–“æ‰æŠŠç¶²ç«™æå®šï¼Œæ‰€ä»¥æ±ºå®šè¦è¨˜éŒ„ä¸€ä¸‹æ•´å€‹æ¶ç«™éç¨‹ï¼ŒåŒ…å« (1) æœ¬æ©Ÿç«¯é–‹ç™¼ç’°å¢ƒçš„å»ºç½®ã€(2) ä¸Šå‚³åˆ° Github Pages ç™¼å¸ƒç¶²ç«™ã€(3) è‡ªè¨‚ç¶²åŸŸï¼Œä»¥ä¾›åƒè€ƒã€‚\n ä»¥ä¸‹ {username} ç‚º GitHub å¸³è™Ÿåï¼Œ{ä¸»é¡Œåç¨±} ç‚ºæ‰€é¸çš„ä½ˆæ™¯ä¸»é¡Œåç¨±ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯ zzoã€‚\n æœ¬æ©Ÿç«¯é–‹ç™¼ç’°å¢ƒçš„å»ºç½® æœ¬æ©Ÿç’°å¢ƒ  ä½œæ¥­ç³»çµ±ï¼šWindows 10\n Hugo å¯ä»¥å®‰è£åœ¨ Windowsã€Linuxã€macOS ç­‰ä½œæ¥­ç³»çµ±ï¼ŒLinux æˆ– macOS çš„å®‰è£æ–¹å¼è«‹åƒè€ƒå®˜æ–¹æ–‡ä»¶ã€‚\nä»¥ä¸‹å»ºç½®éç¨‹é è¨­ç’°å¢ƒå·²å®‰è£ Gitï¼Œä¹Ÿè¨»å†Š GitHub å¸³è™Ÿä¸¦å»ºç«‹åç¨±ç‚º {username}.github.io çš„ repo äº†ã€‚\nå®‰è£å¥—ä»¶ç®¡ç†å™¨ CHOCOLATEY ä»¥ç³»çµ±ç®¡ç†å“¡èº«åˆ†åŸ·è¡Œ PowerShellï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š\n1  Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(\u0026#39;https://chocolatey.org/install.ps1\u0026#39;))   è‹¥å®‰è£ç„¡èª¤ï¼ŒåŸ·è¡Œ choco å¯å¾—ç‰ˆæœ¬è³‡è¨Šï¼Œä¾‹å¦‚ï¼š\n1 2 3  \u0026gt; choco Chocolatey v0.10.15 Please run \u0026#39;choco -?\u0026#39; or \u0026#39;choco \u0026lt;command\u0026gt; -?\u0026#39; for help menu.   å®‰è£ Hugoã€å»ºç«‹æ–°ç¶²ç«™ PowerShell ç¹¼çºŒåŸ·è¡Œï¼š\n1  choco install hugo -confirm   å¦‚æœé¸æ“‡çš„ä¸»é¡Œéœ€è¦æ“´å……å¥—ä»¶ Sass/SCSS ç‰ˆæœ¬ï¼ŒåŸ·è¡Œï¼š\n1  choco install hugo-extended -confirm   è‹¥ä¸ç¢ºå®šæ˜¯å¦éœ€è¦æ“´å……å¥—ä»¶çš„è©±ï¼Œå¯ä»¥å…ˆè·³éï¼Œä¹‹å¾ŒåŸ·è¡Œ hugo server å‡ºç¾ä»¥ä¸‹é¡ä¼¼éŒ¯èª¤æ™‚å†å®‰è£ hugo-extendedï¼š\n ERROR 2021/05/08 16:44:51 TOCSS: failed to transform \u0026ldquo;main_parsed.scss\u0026rdquo; (text/x-scss). Check your Hugo installation; you need the extended version to build SCSS/SASS.\n å®‰è£å®Œ Hugo å¾Œï¼Œå°±å¯ä»¥å»ºç«‹æ–°ç¶²ç«™äº†ã€‚\n1 2  cd myfolder ## Hugo æœƒåœ¨æ­¤è³‡æ–™å¤¾åº•ä¸‹æ–°å»ºä¸€å€‹è³‡æ–™å¤¾ hugo new site mywebsite ## å»ºç«‹ç¶²ç«™ \u0026amp; è³‡æ–™å¤¾ mywebsite   é€™å€‹è³‡æ–™å¤¾åº•ä¸‹æœƒå»ºç«‹ archetypesã€contentã€staticã€themes ç­‰è³‡æ–™å¤¾ï¼Œä½† themes è£¡é¢æ²’æœ‰é è¨­çš„ä½ˆæ™¯ä¸»é¡Œï¼Œéœ€è¦è‡ªå·±å®‰è£ã€‚\nå¯ä»¥åˆ°æ‰€é¸çš„ä¸»é¡Œçš„ GitHub repo ä¸‹è¼‰æª”æ¡ˆè§£å£“ç¸®åˆ° themes/{ä¸»é¡Œåç¨±}/ æˆ–æ˜¯ç”¨ git submodule å®‰è£ï¼ˆä»¥ä¸‹ä»¥ zzo ä¸»é¡Œç‚ºä¾‹ï¼‰ã€‚\n1 2 3  cd mywebsite ## é€²å…¥ç¶²ç«™è³‡æ–™å¤¾ git init git submodule add https://github.com/zzossig/hugo-theme-zzo themes/zzo   å®‰è£å®Œæˆå¾Œï¼Œå®˜æ–¹æ–‡ä»¶ä½¿ç”¨æŒ‡ä»¤æ–°å¢çµ„æ…‹æª” config.tomlï¼š\n1  echo theme = \\\u0026#34;zzo\\\u0026#34; \u0026gt;\u0026gt; config.toml   ä½†å»ºè­°ç›´æ¥è¤‡è£½ç¯„ä¾‹ç¶²ç«™ï¼Œåˆ° themes/{ä¸»é¡Œåç¨±}/exampleSite/ ç›®éŒ„ä¸‹è¤‡è£½æ•´å€‹è³‡æ–™å¤¾å…§å®¹è²¼åˆ° mywebsite æ ¹ç›®éŒ„ï¼Œå†ä¾†ä¿®æ”¹çµ„æ…‹æª”ï¼Œå°¤å…¶æœ‰äº›ä½ˆæ™¯ä¸»é¡Œçš„çµ„æ…‹æª”çµæ§‹è¤‡é›œï¼Œåªæ–°å¢ config.toml å¯èƒ½æœƒç¼ºå°‘æŸäº›åƒæ•¸è€Œç·¨è­¯å¤±æ•—ã€‚\nå¦‚æœè¦è‡ªè¨‚ layouts æˆ– i18n çš„å…§å®¹ï¼Œä¹Ÿå¾ themes/{ä¸»é¡Œåç¨±}/ ä¸‹è¤‡è£½è³‡æ–™å¤¾åˆ°æ ¹ç›®éŒ„å¾Œé€²è¡Œä¿®æ”¹ã€‚\nå…ˆä¾†è¨­å®š config.toml çš„ baseURL å’Œç¶²ç«™èªè¨€ç­‰ï¼š\n1 2 3 4 5 6 7  # å¦‚æœä½¿ç”¨ GitHub Pages é è¨­åŸŸå baseURL = \u0026#34;https://{username}.github.io/\u0026#34; # è‡ªè¨‚åŸŸåç¯„ä¾‹ baseURL = \u0026#34;https://www.customdomainname.com/\u0026#34; languageCode = \u0026#34;zh-tw\u0026#34; title = \u0026#34;My Site Name\u0026#34; #è‡ªè¨‚ä»»æ„åç¨±   æœ¬æ©Ÿç«¯å•Ÿå‹•ç¶²ç«™ï¼š\nä»¥ hugo servre æ–¹å¼å•Ÿå‹•ç¶²ç«™ï¼ŒHugo æœƒéš¨æ™‚åµæ¸¬æª”æ¡ˆçš„ç•°å‹•ä¾†æ›´æ–°ç¶²é ï¼Œåˆ°é è¨­ç¶²å€ http://localhost:1313/ å°±å¯ä»¥çœ‹åˆ°æœ€æ–°çš„å…§å®¹ï¼Œé—œé–‰ç¶²ç«™ç”¨ CTRL+C ã€‚\n1  hugo server   ä¸Šå‚³åˆ° Github Pages ç™¼å¸ƒç¶²ç«™ å®˜æ–¹æ–‡ä»¶ä½¿ç”¨ GitHub Action ä¾†ä½ˆç½²ç¶²ç«™ï¼ˆæ–¹æ³•ä¸€ï¼‰ï¼Œä½†å¦‚æœä¸å¸Œæœ›å°‡ç¶²ç«™çš„åŸå§‹ç¢¼æ”¾åˆ°ç¶²è·¯ä¸Šï¼Œå¯ä»¥é¸æ“‡åªæäº¤æœ€å¾Œç·¨è­¯å¥½çš„éœæ…‹ç¶²é ï¼ˆæ–¹æ³•äºŒï¼‰ã€‚\næ–¹æ³•ä¸€ï¼šå»ºç«‹ gh-pages åˆ†æ”¯ å…ˆç¢ºå®šä½¿ç”¨çš„ Hugo ç‰ˆæœ¬ï¼Œä»¥åŠæ˜¯å¦å®‰è£æ“´å……å¥—ä»¶ã€‚\n1 2  \u0026gt; hugo version hugo v0.83.1-5AFE0A57+extended windows/amd64 BuildDate=2021-05-02T14:38:05Z VendorInfo=gohugoio   å°‡æ•´å€‹è³‡æ–™å¤¾ Push åˆ° Github repo ï¼ˆ{username}.github.ioï¼‰ï¼š\n1 2 3 4 5 6  ## ç¾åœ¨è·¯å¾‘ç‚º myfolder/mywebsite/ git branch -M main git add . git commit -m \u0026#34;init mywebsite\u0026#34; git remote add origin https://github.com/{username}/{username}.github.io.git git push -u origin main   å†åˆ° GitHub æ–°å¢ gh-pages.yml æª”æ¡ˆã€‚\n  åœ¨ä¸Šåœ–æ­¥é©Ÿ 2 æ™‚ï¼Œå°‡ gh-pages.yml å…§å®¹ç”¨ä»¥ä¸‹å…§å®¹å–ä»£ï¼Œå…¶ä¸­ hugo-version å’Œ extended å†ä¾éœ€æ±‚é€²è¡Œè¨­å®šï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  name:github pageson:push:branches:- main # Set a branch to deployjobs:deploy:runs-on:ubuntu-18.04steps:- uses:actions/checkout@v2with:submodules:true# Fetch Hugo themes (true OR recursive)fetch-depth:0# Fetch all history for .GitInfo and .Lastmod- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:\u0026#39;latest\u0026#39;# \u0026#39;0.83.1\u0026#39;# extended: true # æœ‰ç”¨æ“´å……å¥—ä»¶å‰‡å°‡ # ç§»é™¤- name:Buildrun:hugo --minify- name:Deployuses:peaceiris/actions-gh-pages@v3with:github_token:${{ secrets.GITHUB_TOKEN }}publish_dir:./public  Commit å®Œæˆå¾Œï¼Œæª¢æŸ¥ workflow æ˜¯å¦é †åˆ©ã€‚ï¼ˆä¹‹å¾Œæ¯æ¬¡ main åˆ†æ”¯æœ‰ commit å°±æœƒæœ‰æ–°çš„ workflow è‡ªå‹•ç”¢ç”Ÿï¼Œé‡æ–°ç·¨è­¯ç™¼å¸ƒç¶²ç«™ï¼‰\n  å…¨éƒ¨éƒ½ âœ” è¡¨ç¤ºé †åˆ©å®Œæˆç·¨è­¯å›‰ã€‚\næ¥ä¸‹ä¾†è¨­å®š GitHub Pages è¦è®€å– gh-pages åˆ†æ”¯çš„æª”æ¡ˆï¼Œè¨­å®šå®Œå°±å¯ä»¥åˆ° https://{username}.github.io ç€è¦½ç¶²ç«™æˆæœã€‚\n æ–¹æ³•äºŒï¼šä¸Šå‚³ Public è³‡æ–™å¤¾ å…ˆä»¥ hugo ç”¢ç”Ÿéœæ…‹ html æª”æ¡ˆï¼ŒæˆåŠŸçš„è©±æœƒåœ¨ mywebsite/public/ è£¡é¢çœ‹åˆ°æª”æ¡ˆï¼Œå†å°‡ public è³‡æ–™å¤¾ push åˆ° GitHubã€‚\n1 2 3 4 5 6 7 8 9  ## ç¾åœ¨è·¯å¾‘ç‚º myfolder/mywebsite/ git submodule add https://github.com/{username}/{username}.github.io.git public hugo # ç”¢ç”Ÿéœæ…‹ html æª”æ¡ˆ cd public git status # æª¢æŸ¥ public è³‡æ–™å¤¾ï¼Œæ‡‰åªçœ‹åˆ° public ä¸­æ–°å¢çš„æª”æ¡ˆ git branch -M main git add . git commit -m \u0026#34;init mywebsite\u0026#34; git push -u origin main   åƒè€ƒä¸Šåœ–åˆ° GitHub Pages è¨­å®šè¦è®€å–çš„åˆ†æ”¯ç‚º mainï¼Œå°±å¯ä»¥è¨ªå• https://{username}.github.ioã€‚\nè‡ªè¨‚ç¶²åŸŸ GitHub å®˜æ–¹å»ºè­°å…ˆåœ¨ GitHub ä¸­è¨­å®š CNAMEï¼Œå†åˆ° DNS ä¾›æ‡‰å•†è¨­å®š DNS ç´€éŒ„ã€‚\næ–°å¢æª”æ¡ˆ CNAME åœ¨ GitHub ç¶²ç«™ä»‹é¢ä¸­å¯ä»¥è¨­å®šç¶²åŸŸåï¼Œå…¶æ©Ÿåˆ¶æ˜¯åœ¨ Pages çš„ç›®æ¨™åˆ†æ”¯æ ¹ç›®éŒ„ä¸‹åŠ ä¸Š CNAMEï¼Œä½†æ˜¯é€™æ¨£æ¯æ¬¡æœ‰æª”æ¡ˆæ›´æ–° CNAME å°±æœƒè¢«è¦†è“‹æ‰ï¼Œè¦å†é‡æ–°è¨­å®šï¼Œæ‰€ä»¥ Hugo ç¶²ç«™æ˜¯è¦æ–°å¢ CNAME åœ¨ static è³‡æ–™å¤¾ä¸­ï¼Œé€™æ¨£ç·¨è­¯å¾Œï¼Œæª”æ¡ˆæœƒè‡ªå‹•æ”¾åœ¨ç¶²ç«™æ ¹ç›®éŒ„ä¸‹ï¼ŒGitHub å°±èƒ½ä»¥æ­¤åµæ¸¬è‡ªè¨‚åŸŸåã€‚\nCNAME æª”æ¡ˆï¼ˆç„¡å‰¯æª”åï¼‰å…§å®¹å°±åªæ”¾è‡ªè¨‚çš„ç¶²åŸŸåï¼ˆä¾‹å¦‚ www.customdomainname.comï¼‰ã€‚\nè¨­å®š DNS åˆ° DNS ä¾›æ‡‰å•†è¨­å®š DNS ç´€éŒ„ï¼Œå¢åŠ  4 ç­† A Record å’Œ 1 ç­† CNAME Recordï¼ˆä»¥ www ç‚ºä¾‹ï¼‰ã€‚\n   Type Host Value     A Record @ 185.199.108.153   A Record @ 185.199.109.153   A Record @ 185.199.110.153   A Record @ 185.199.111.153   CNAME Record www {username}.github.io    æ›´æ”¹ repo åç¨±ï¼ˆéå¿…è¦ï¼‰ æœ€å¾Œå¯ä»¥å°‡ repo åç¨±æ”¹ç‚ºç¾åœ¨çš„ç¶²åŸŸï¼Œç„¶å¾Œå°‡ Pages çš„ Enforce HTTPS å–æ¶ˆå†é‡æ–°å‹¾é¸ï¼Œè®“ SSL æ†‘è­‰é‡æ–°ç”¢ç”Ÿã€‚\nçµè«– åŸºæœ¬ä¸Šä¸€æ­¥ä¸€æ­¥åŸ·è¡Œå°±å¯ä»¥å®Œæˆ Hugo ç¶²ç«™å»ºç½®ï¼Œå¦‚æœä¸€é–‹å§‹å°±æ‰“ç®—è‡ªè¨‚ç¶²åŸŸä¹Ÿå¯ä»¥å…ˆæ–°å¢ CNAME æª”æ¡ˆä»¥åŠç”¨è‡ªè¨‚ç¶²åŸŸä½œ repo åç¨±ä¾†ç°¡åŒ–æ­¥é©Ÿï¼\nåƒè€ƒç¶²å€ï¼š  Hugo Docs GitHub Docs è‡ªè¨‚ç¶²åŸŸ  å…¶ä»–ï¼š  ç·¨å¯« Markdown æ–‡ä»¶ ","description":"ä½¿ç”¨ Hugo åœ¨ GitHub Pages æ¶è¨­éœæ…‹ç¶²ç«™ï¼ŒåŒ…å« (1) æœ¬æ©Ÿç«¯é–‹ç™¼ç’°å¢ƒçš„å»ºç½®ã€(2) ä¸Šå‚³åˆ° Github Pages ç™¼å¸ƒç¶²ç«™ã€(3) è‡ªè¨‚ç¶²åŸŸã€‚","id":7,"section":"posts","tags":["Hugo","Static Site Generator","Git","GitHub Pages"],"title":"ç¶²ç«™é–‹å¼µï¼åœ¨ GitHub Pages æ¶è¨­ Hugo éœæ…‹ç¶²ç«™","uri":"https://www.zoeydc.com/zh/posts/2021-05-23-hugo-website_github-pages_custom-domain/"}]